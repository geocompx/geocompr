<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Bridges to GIS software | Geocomputation with R</title>
  <meta name="description" content="Chapter 9 Bridges to GIS software | Geocomputation with R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, visualization, and geospatial capabilities. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS) users interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Bridges to GIS software | Geocomputation with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://geocompr.robinlovelace.net/" />
  <meta property="og:image" content="https://geocompr.robinlovelace.net//images/cover.png" />
  <meta property="og:description" content="Chapter 9 Bridges to GIS software | Geocomputation with R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, visualization, and geospatial capabilities. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS) users interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="github-repo" content="Robinlovelace/geocompr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Bridges to GIS software | Geocomputation with R" />
  
  <meta name="twitter:description" content="Chapter 9 Bridges to GIS software | Geocomputation with R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, visualization, and geospatial capabilities. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS) users interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="twitter:image" content="https://geocompr.robinlovelace.net//images/cover.png" />

<meta name="author" content="Robin Lovelace, Jakub Nowosad, Jannes Muenchow" />


<meta name="date" content="2021-08-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="adv-map.html"/>
<link rel="next" href="algorithms.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99618359-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Geocomputation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reproducibility"><i class="fa fa-check"></i>Reproducibility</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#supporting-the-project"><i class="fa fa-check"></i>Supporting the project</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#who-this-book-is-for"><i class="fa fa-check"></i>Who this book is for</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#how-to-read-this-book"><i class="fa fa-check"></i>How to read this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#why-r"><i class="fa fa-check"></i>Why R?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#real-world-impact"><i class="fa fa-check"></i>Real-world impact</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what-is-geocomputation"><i class="fa fa-check"></i><b>1.1</b> What is geocomputation?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#why-use-r-for-geocomputation"><i class="fa fa-check"></i><b>1.2</b> Why use R for geocomputation?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#software-for-geocomputation"><i class="fa fa-check"></i><b>1.3</b> Software for geocomputation</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#rs-spatial-ecosystem"><i class="fa fa-check"></i><b>1.4</b> R’s spatial ecosystem</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#the-history-of-r-spatial"><i class="fa fa-check"></i><b>1.5</b> The history of R-spatial</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="2" data-path="spatial-class.html"><a href="spatial-class.html"><i class="fa fa-check"></i><b>2</b> Geographic data in R</a><ul>
<li class="chapter" data-level="" data-path="spatial-class.html"><a href="spatial-class.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="2.1" data-path="spatial-class.html"><a href="spatial-class.html#intro-spatial-class"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="spatial-class.html"><a href="spatial-class.html#vector-data"><i class="fa fa-check"></i><b>2.2</b> Vector data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="spatial-class.html"><a href="spatial-class.html#intro-sf"><i class="fa fa-check"></i><b>2.2.1</b> An introduction to simple features</a></li>
<li class="chapter" data-level="2.2.2" data-path="spatial-class.html"><a href="spatial-class.html#why-simple-features"><i class="fa fa-check"></i><b>2.2.2</b> Why simple features?</a></li>
<li class="chapter" data-level="2.2.3" data-path="spatial-class.html"><a href="spatial-class.html#basic-map"><i class="fa fa-check"></i><b>2.2.3</b> Basic map making</a></li>
<li class="chapter" data-level="2.2.4" data-path="spatial-class.html"><a href="spatial-class.html#base-args"><i class="fa fa-check"></i><b>2.2.4</b> Base plot arguments</a></li>
<li class="chapter" data-level="2.2.5" data-path="spatial-class.html"><a href="spatial-class.html#geometry"><i class="fa fa-check"></i><b>2.2.5</b> Geometry types</a></li>
<li class="chapter" data-level="2.2.6" data-path="spatial-class.html"><a href="spatial-class.html#sfg"><i class="fa fa-check"></i><b>2.2.6</b> Simple feature geometries (sfg)</a></li>
<li class="chapter" data-level="2.2.7" data-path="spatial-class.html"><a href="spatial-class.html#sfc"><i class="fa fa-check"></i><b>2.2.7</b> Simple feature columns (sfc)</a></li>
<li class="chapter" data-level="2.2.8" data-path="spatial-class.html"><a href="spatial-class.html#sf"><i class="fa fa-check"></i><b>2.2.8</b> The sf class</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="spatial-class.html"><a href="spatial-class.html#raster-data"><i class="fa fa-check"></i><b>2.3</b> Raster data</a><ul>
<li class="chapter" data-level="2.3.1" data-path="spatial-class.html"><a href="spatial-class.html#an-introduction-to-raster"><i class="fa fa-check"></i><b>2.3.1</b> An introduction to raster</a></li>
<li class="chapter" data-level="2.3.2" data-path="spatial-class.html"><a href="spatial-class.html#basic-map-raster"><i class="fa fa-check"></i><b>2.3.2</b> Basic map making</a></li>
<li class="chapter" data-level="2.3.3" data-path="spatial-class.html"><a href="spatial-class.html#raster-classes"><i class="fa fa-check"></i><b>2.3.3</b> Raster classes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="spatial-class.html"><a href="spatial-class.html#crs-intro"><i class="fa fa-check"></i><b>2.4</b> Coordinate Reference Systems</a><ul>
<li class="chapter" data-level="2.4.1" data-path="spatial-class.html"><a href="spatial-class.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>2.4.1</b> Geographic coordinate systems</a></li>
<li class="chapter" data-level="2.4.2" data-path="spatial-class.html"><a href="spatial-class.html#projected-coordinate-reference-systems"><i class="fa fa-check"></i><b>2.4.2</b> Projected coordinate reference systems</a></li>
<li class="chapter" data-level="2.4.3" data-path="spatial-class.html"><a href="spatial-class.html#crs-in-r"><i class="fa fa-check"></i><b>2.4.3</b> CRSs in R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="spatial-class.html"><a href="spatial-class.html#units"><i class="fa fa-check"></i><b>2.5</b> Units</a></li>
<li class="chapter" data-level="2.6" data-path="spatial-class.html"><a href="spatial-class.html#ex2"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="attr.html"><a href="attr.html"><i class="fa fa-check"></i><b>3</b> Attribute data operations</a><ul>
<li class="chapter" data-level="" data-path="attr.html"><a href="attr.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="3.1" data-path="attr.html"><a href="attr.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="attr.html"><a href="attr.html#vector-attribute-manipulation"><i class="fa fa-check"></i><b>3.2</b> Vector attribute manipulation</a><ul>
<li class="chapter" data-level="3.2.1" data-path="attr.html"><a href="attr.html#vector-attribute-subsetting"><i class="fa fa-check"></i><b>3.2.1</b> Vector attribute subsetting</a></li>
<li class="chapter" data-level="3.2.2" data-path="attr.html"><a href="attr.html#vector-attribute-aggregation"><i class="fa fa-check"></i><b>3.2.2</b> Vector attribute aggregation</a></li>
<li class="chapter" data-level="3.2.3" data-path="attr.html"><a href="attr.html#vector-attribute-joining"><i class="fa fa-check"></i><b>3.2.3</b> Vector attribute joining</a></li>
<li class="chapter" data-level="3.2.4" data-path="attr.html"><a href="attr.html#vec-attr-creation"><i class="fa fa-check"></i><b>3.2.4</b> Creating attributes and removing spatial information</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="attr.html"><a href="attr.html#manipulating-raster-objects"><i class="fa fa-check"></i><b>3.3</b> Manipulating raster objects</a><ul>
<li class="chapter" data-level="3.3.1" data-path="attr.html"><a href="attr.html#raster-subsetting"><i class="fa fa-check"></i><b>3.3.1</b> Raster subsetting</a></li>
<li class="chapter" data-level="3.3.2" data-path="attr.html"><a href="attr.html#summarizing-raster-objects"><i class="fa fa-check"></i><b>3.3.2</b> Summarizing raster objects</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="attr.html"><a href="attr.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-operations.html"><a href="spatial-operations.html"><i class="fa fa-check"></i><b>4</b> Spatial data operations</a><ul>
<li class="chapter" data-level="" data-path="spatial-operations.html"><a href="spatial-operations.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="4.1" data-path="spatial-operations.html"><a href="spatial-operations.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-vec"><i class="fa fa-check"></i><b>4.2</b> Spatial operations on vector data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-subsetting"><i class="fa fa-check"></i><b>4.2.1</b> Spatial subsetting</a></li>
<li class="chapter" data-level="4.2.2" data-path="spatial-operations.html"><a href="spatial-operations.html#topological-relations"><i class="fa fa-check"></i><b>4.2.2</b> Topological relations</a></li>
<li class="chapter" data-level="4.2.3" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-joining"><i class="fa fa-check"></i><b>4.2.3</b> Spatial joining</a></li>
<li class="chapter" data-level="4.2.4" data-path="spatial-operations.html"><a href="spatial-operations.html#non-overlapping-joins"><i class="fa fa-check"></i><b>4.2.4</b> Non-overlapping joins</a></li>
<li class="chapter" data-level="4.2.5" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-aggr"><i class="fa fa-check"></i><b>4.2.5</b> Spatial data aggregation</a></li>
<li class="chapter" data-level="4.2.6" data-path="spatial-operations.html"><a href="spatial-operations.html#distance-relations"><i class="fa fa-check"></i><b>4.2.6</b> Distance relations</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-ras"><i class="fa fa-check"></i><b>4.3</b> Spatial operations on raster data</a><ul>
<li class="chapter" data-level="4.3.1" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-raster-subsetting"><i class="fa fa-check"></i><b>4.3.1</b> Spatial subsetting</a></li>
<li class="chapter" data-level="4.3.2" data-path="spatial-operations.html"><a href="spatial-operations.html#map-algebra"><i class="fa fa-check"></i><b>4.3.2</b> Map algebra</a></li>
<li class="chapter" data-level="4.3.3" data-path="spatial-operations.html"><a href="spatial-operations.html#local-operations"><i class="fa fa-check"></i><b>4.3.3</b> Local operations</a></li>
<li class="chapter" data-level="4.3.4" data-path="spatial-operations.html"><a href="spatial-operations.html#focal-operations"><i class="fa fa-check"></i><b>4.3.4</b> Focal operations</a></li>
<li class="chapter" data-level="4.3.5" data-path="spatial-operations.html"><a href="spatial-operations.html#zonal-operations"><i class="fa fa-check"></i><b>4.3.5</b> Zonal operations</a></li>
<li class="chapter" data-level="4.3.6" data-path="spatial-operations.html"><a href="spatial-operations.html#global-operations-and-distances"><i class="fa fa-check"></i><b>4.3.6</b> Global operations and distances</a></li>
<li class="chapter" data-level="4.3.7" data-path="spatial-operations.html"><a href="spatial-operations.html#map-algebra-counterparts-in-vector-processing"><i class="fa fa-check"></i><b>4.3.7</b> Map algebra counterparts in vector processing</a></li>
<li class="chapter" data-level="4.3.8" data-path="spatial-operations.html"><a href="spatial-operations.html#merging-rasters"><i class="fa fa-check"></i><b>4.3.8</b> Merging rasters</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="spatial-operations.html"><a href="spatial-operations.html#exercises-2"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="geometric-operations.html"><a href="geometric-operations.html"><i class="fa fa-check"></i><b>5</b> Geometry operations</a><ul>
<li class="chapter" data-level="" data-path="geometric-operations.html"><a href="geometric-operations.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="5.1" data-path="geometric-operations.html"><a href="geometric-operations.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="geometric-operations.html"><a href="geometric-operations.html#geo-vec"><i class="fa fa-check"></i><b>5.2</b> Geometric operations on vector data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="geometric-operations.html"><a href="geometric-operations.html#simplification"><i class="fa fa-check"></i><b>5.2.1</b> Simplification</a></li>
<li class="chapter" data-level="5.2.2" data-path="geometric-operations.html"><a href="geometric-operations.html#centroids"><i class="fa fa-check"></i><b>5.2.2</b> Centroids</a></li>
<li class="chapter" data-level="5.2.3" data-path="geometric-operations.html"><a href="geometric-operations.html#buffers"><i class="fa fa-check"></i><b>5.2.3</b> Buffers</a></li>
<li class="chapter" data-level="5.2.4" data-path="geometric-operations.html"><a href="geometric-operations.html#affine-transformations"><i class="fa fa-check"></i><b>5.2.4</b> Affine transformations</a></li>
<li class="chapter" data-level="5.2.5" data-path="geometric-operations.html"><a href="geometric-operations.html#clipping"><i class="fa fa-check"></i><b>5.2.5</b> Clipping</a></li>
<li class="chapter" data-level="5.2.6" data-path="geometric-operations.html"><a href="geometric-operations.html#geometry-unions"><i class="fa fa-check"></i><b>5.2.6</b> Geometry unions</a></li>
<li class="chapter" data-level="5.2.7" data-path="geometric-operations.html"><a href="geometric-operations.html#type-trans"><i class="fa fa-check"></i><b>5.2.7</b> Type transformations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="geometric-operations.html"><a href="geometric-operations.html#geo-ras"><i class="fa fa-check"></i><b>5.3</b> Geometric operations on raster data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="geometric-operations.html"><a href="geometric-operations.html#geometric-intersections"><i class="fa fa-check"></i><b>5.3.1</b> Geometric intersections</a></li>
<li class="chapter" data-level="5.3.2" data-path="geometric-operations.html"><a href="geometric-operations.html#extent-and-origin"><i class="fa fa-check"></i><b>5.3.2</b> Extent and origin</a></li>
<li class="chapter" data-level="5.3.3" data-path="geometric-operations.html"><a href="geometric-operations.html#aggregation-and-disaggregation"><i class="fa fa-check"></i><b>5.3.3</b> Aggregation and disaggregation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="geometric-operations.html"><a href="geometric-operations.html#raster-vector"><i class="fa fa-check"></i><b>5.4</b> Raster-vector interactions</a><ul>
<li class="chapter" data-level="5.4.1" data-path="geometric-operations.html"><a href="geometric-operations.html#raster-cropping"><i class="fa fa-check"></i><b>5.4.1</b> Raster cropping</a></li>
<li class="chapter" data-level="5.4.2" data-path="geometric-operations.html"><a href="geometric-operations.html#raster-extraction"><i class="fa fa-check"></i><b>5.4.2</b> Raster extraction</a></li>
<li class="chapter" data-level="5.4.3" data-path="geometric-operations.html"><a href="geometric-operations.html#rasterization"><i class="fa fa-check"></i><b>5.4.3</b> Rasterization</a></li>
<li class="chapter" data-level="5.4.4" data-path="geometric-operations.html"><a href="geometric-operations.html#spatial-vectorization"><i class="fa fa-check"></i><b>5.4.4</b> Spatial vectorization</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="geometric-operations.html"><a href="geometric-operations.html#exercises-3"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html"><i class="fa fa-check"></i><b>6</b> Reprojecting geographic data</a><ul>
<li class="chapter" data-level="" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="6.1" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#when-to-reproject"><i class="fa fa-check"></i><b>6.2</b> When to reproject?</a></li>
<li class="chapter" data-level="6.3" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#which-crs-to-use"><i class="fa fa-check"></i><b>6.3</b> Which CRS to use?</a></li>
<li class="chapter" data-level="6.4" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#reproj-vec-geom"><i class="fa fa-check"></i><b>6.4</b> Reprojecting vector geometries</a></li>
<li class="chapter" data-level="6.5" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#modifying-map-projections"><i class="fa fa-check"></i><b>6.5</b> Modifying map projections</a></li>
<li class="chapter" data-level="6.6" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#reprojecting-raster-geometries"><i class="fa fa-check"></i><b>6.6</b> Reprojecting raster geometries</a></li>
<li class="chapter" data-level="6.7" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#exercises-4"><i class="fa fa-check"></i><b>6.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="read-write.html"><a href="read-write.html"><i class="fa fa-check"></i><b>7</b> Geographic data I/O</a><ul>
<li class="chapter" data-level="" data-path="read-write.html"><a href="read-write.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="7.1" data-path="read-write.html"><a href="read-write.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="read-write.html"><a href="read-write.html#retrieving-data"><i class="fa fa-check"></i><b>7.2</b> Retrieving open data</a></li>
<li class="chapter" data-level="7.3" data-path="read-write.html"><a href="read-write.html#geographic-data-packages"><i class="fa fa-check"></i><b>7.3</b> Geographic data packages</a></li>
<li class="chapter" data-level="7.4" data-path="read-write.html"><a href="read-write.html#geographic-web-services"><i class="fa fa-check"></i><b>7.4</b> Geographic web services</a></li>
<li class="chapter" data-level="7.5" data-path="read-write.html"><a href="read-write.html#file-formats"><i class="fa fa-check"></i><b>7.5</b> File formats</a></li>
<li class="chapter" data-level="7.6" data-path="read-write.html"><a href="read-write.html#data-input"><i class="fa fa-check"></i><b>7.6</b> Data input (I)</a><ul>
<li class="chapter" data-level="7.6.1" data-path="read-write.html"><a href="read-write.html#vector-data-1"><i class="fa fa-check"></i><b>7.6.1</b> Vector data</a></li>
<li class="chapter" data-level="7.6.2" data-path="read-write.html"><a href="read-write.html#raster-data-1"><i class="fa fa-check"></i><b>7.6.2</b> Raster data</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="read-write.html"><a href="read-write.html#data-output"><i class="fa fa-check"></i><b>7.7</b> Data output (O)</a><ul>
<li class="chapter" data-level="7.7.1" data-path="read-write.html"><a href="read-write.html#vector-data-2"><i class="fa fa-check"></i><b>7.7.1</b> Vector data</a></li>
<li class="chapter" data-level="7.7.2" data-path="read-write.html"><a href="read-write.html#raster-data-2"><i class="fa fa-check"></i><b>7.7.2</b> Raster data</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="read-write.html"><a href="read-write.html#visual-outputs"><i class="fa fa-check"></i><b>7.8</b> Visual outputs</a></li>
<li class="chapter" data-level="7.9" data-path="read-write.html"><a href="read-write.html#exercises-5"><i class="fa fa-check"></i><b>7.9</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Extensions</b></span></li>
<li class="chapter" data-level="8" data-path="adv-map.html"><a href="adv-map.html"><i class="fa fa-check"></i><b>8</b> Making maps with R</a><ul>
<li class="chapter" data-level="" data-path="adv-map.html"><a href="adv-map.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="8.1" data-path="adv-map.html"><a href="adv-map.html#introduction-5"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="adv-map.html"><a href="adv-map.html#static-maps"><i class="fa fa-check"></i><b>8.2</b> Static maps</a><ul>
<li class="chapter" data-level="8.2.1" data-path="adv-map.html"><a href="adv-map.html#tmap-basics"><i class="fa fa-check"></i><b>8.2.1</b> tmap basics</a></li>
<li class="chapter" data-level="8.2.2" data-path="adv-map.html"><a href="adv-map.html#map-obj"><i class="fa fa-check"></i><b>8.2.2</b> Map objects</a></li>
<li class="chapter" data-level="8.2.3" data-path="adv-map.html"><a href="adv-map.html#aesthetics"><i class="fa fa-check"></i><b>8.2.3</b> Aesthetics</a></li>
<li class="chapter" data-level="8.2.4" data-path="adv-map.html"><a href="adv-map.html#color-settings"><i class="fa fa-check"></i><b>8.2.4</b> Color settings</a></li>
<li class="chapter" data-level="8.2.5" data-path="adv-map.html"><a href="adv-map.html#layouts"><i class="fa fa-check"></i><b>8.2.5</b> Layouts</a></li>
<li class="chapter" data-level="8.2.6" data-path="adv-map.html"><a href="adv-map.html#faceted-maps"><i class="fa fa-check"></i><b>8.2.6</b> Faceted maps</a></li>
<li class="chapter" data-level="8.2.7" data-path="adv-map.html"><a href="adv-map.html#inset-maps"><i class="fa fa-check"></i><b>8.2.7</b> Inset maps</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="adv-map.html"><a href="adv-map.html#animated-maps"><i class="fa fa-check"></i><b>8.3</b> Animated maps</a></li>
<li class="chapter" data-level="8.4" data-path="adv-map.html"><a href="adv-map.html#interactive-maps"><i class="fa fa-check"></i><b>8.4</b> Interactive maps</a></li>
<li class="chapter" data-level="8.5" data-path="adv-map.html"><a href="adv-map.html#mapping-applications"><i class="fa fa-check"></i><b>8.5</b> Mapping applications</a></li>
<li class="chapter" data-level="8.6" data-path="adv-map.html"><a href="adv-map.html#other-mapping-packages"><i class="fa fa-check"></i><b>8.6</b> Other mapping packages</a></li>
<li class="chapter" data-level="8.7" data-path="adv-map.html"><a href="adv-map.html#exercises-6"><i class="fa fa-check"></i><b>8.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="gis.html"><a href="gis.html"><i class="fa fa-check"></i><b>9</b> Bridges to GIS software</a><ul>
<li class="chapter" data-level="" data-path="gis.html"><a href="gis.html#prerequisites-7"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="9.1" data-path="gis.html"><a href="gis.html#introduction-6"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="gis.html"><a href="gis.html#rqgis"><i class="fa fa-check"></i><b>9.2</b> (R)QGIS</a></li>
<li class="chapter" data-level="9.3" data-path="gis.html"><a href="gis.html#rsaga"><i class="fa fa-check"></i><b>9.3</b> (R)SAGA</a></li>
<li class="chapter" data-level="9.4" data-path="gis.html"><a href="gis.html#rgrass"><i class="fa fa-check"></i><b>9.4</b> GRASS through <strong>rgrass7</strong></a></li>
<li class="chapter" data-level="9.5" data-path="gis.html"><a href="gis.html#when-to-use-what"><i class="fa fa-check"></i><b>9.5</b> When to use what?</a></li>
<li class="chapter" data-level="9.6" data-path="gis.html"><a href="gis.html#other-bridges"><i class="fa fa-check"></i><b>9.6</b> Other bridges</a><ul>
<li class="chapter" data-level="9.6.1" data-path="gis.html"><a href="gis.html#gdal"><i class="fa fa-check"></i><b>9.6.1</b> Bridges to GDAL</a></li>
<li class="chapter" data-level="9.6.2" data-path="gis.html"><a href="gis.html#postgis"><i class="fa fa-check"></i><b>9.6.2</b> Bridges to spatial databases</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="gis.html"><a href="gis.html#exercises-7"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>10</b> Scripts, algorithms and functions</a><ul>
<li class="chapter" data-level="" data-path="algorithms.html"><a href="algorithms.html#prerequisites-8"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="10.1" data-path="algorithms.html"><a href="algorithms.html#intro-algorithms"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="algorithms.html"><a href="algorithms.html#scripts"><i class="fa fa-check"></i><b>10.2</b> Scripts</a></li>
<li class="chapter" data-level="10.3" data-path="algorithms.html"><a href="algorithms.html#geometric-algorithms"><i class="fa fa-check"></i><b>10.3</b> Geometric algorithms</a></li>
<li class="chapter" data-level="10.4" data-path="algorithms.html"><a href="algorithms.html#functions"><i class="fa fa-check"></i><b>10.4</b> Functions</a></li>
<li class="chapter" data-level="10.5" data-path="algorithms.html"><a href="algorithms.html#programming"><i class="fa fa-check"></i><b>10.5</b> Programming</a></li>
<li class="chapter" data-level="10.6" data-path="algorithms.html"><a href="algorithms.html#ex-algorithms"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="spatial-cv.html"><a href="spatial-cv.html"><i class="fa fa-check"></i><b>11</b> Statistical learning</a><ul>
<li class="chapter" data-level="" data-path="spatial-cv.html"><a href="spatial-cv.html#prerequisites-9"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="11.1" data-path="spatial-cv.html"><a href="spatial-cv.html#intro-cv1"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="spatial-cv.html"><a href="spatial-cv.html#case-landslide"><i class="fa fa-check"></i><b>11.2</b> Case study: Landslide susceptibility</a></li>
<li class="chapter" data-level="11.3" data-path="spatial-cv.html"><a href="spatial-cv.html#conventional-model"><i class="fa fa-check"></i><b>11.3</b> Conventional modeling approach in R</a></li>
<li class="chapter" data-level="11.4" data-path="spatial-cv.html"><a href="spatial-cv.html#intro-cv"><i class="fa fa-check"></i><b>11.4</b> Introduction to (spatial) cross-validation</a></li>
<li class="chapter" data-level="11.5" data-path="spatial-cv.html"><a href="spatial-cv.html#spatial-cv-with-mlr"><i class="fa fa-check"></i><b>11.5</b> Spatial CV with <strong>mlr</strong></a><ul>
<li class="chapter" data-level="11.5.1" data-path="spatial-cv.html"><a href="spatial-cv.html#glm"><i class="fa fa-check"></i><b>11.5.1</b> Generalized linear model</a></li>
<li class="chapter" data-level="11.5.2" data-path="spatial-cv.html"><a href="spatial-cv.html#svm"><i class="fa fa-check"></i><b>11.5.2</b> Spatial tuning of machine-learning hyperparameters</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="spatial-cv.html"><a href="spatial-cv.html#conclusions"><i class="fa fa-check"></i><b>11.6</b> Conclusions</a></li>
<li class="chapter" data-level="11.7" data-path="spatial-cv.html"><a href="spatial-cv.html#exercises-8"><i class="fa fa-check"></i><b>11.7</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Applications</b></span></li>
<li class="chapter" data-level="12" data-path="transport.html"><a href="transport.html"><i class="fa fa-check"></i><b>12</b> Transportation</a><ul>
<li class="chapter" data-level="" data-path="transport.html"><a href="transport.html#prerequisites-10"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="12.1" data-path="transport.html"><a href="transport.html#introduction-7"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="transport.html"><a href="transport.html#bris-case"><i class="fa fa-check"></i><b>12.2</b> A case study of Bristol</a></li>
<li class="chapter" data-level="12.3" data-path="transport.html"><a href="transport.html#transport-zones"><i class="fa fa-check"></i><b>12.3</b> Transport zones</a></li>
<li class="chapter" data-level="12.4" data-path="transport.html"><a href="transport.html#desire-lines"><i class="fa fa-check"></i><b>12.4</b> Desire lines</a></li>
<li class="chapter" data-level="12.5" data-path="transport.html"><a href="transport.html#routes"><i class="fa fa-check"></i><b>12.5</b> Routes</a></li>
<li class="chapter" data-level="12.6" data-path="transport.html"><a href="transport.html#nodes"><i class="fa fa-check"></i><b>12.6</b> Nodes</a></li>
<li class="chapter" data-level="12.7" data-path="transport.html"><a href="transport.html#route-networks"><i class="fa fa-check"></i><b>12.7</b> Route networks</a></li>
<li class="chapter" data-level="12.8" data-path="transport.html"><a href="transport.html#prioritizing-new-infrastructure"><i class="fa fa-check"></i><b>12.8</b> Prioritizing new infrastructure</a></li>
<li class="chapter" data-level="12.9" data-path="transport.html"><a href="transport.html#future-directions-of-travel"><i class="fa fa-check"></i><b>12.9</b> Future directions of travel</a></li>
<li class="chapter" data-level="12.10" data-path="transport.html"><a href="transport.html#ex-transport"><i class="fa fa-check"></i><b>12.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="location.html"><a href="location.html"><i class="fa fa-check"></i><b>13</b> Geomarketing</a><ul>
<li class="chapter" data-level="" data-path="location.html"><a href="location.html#prerequisites-11"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="13.1" data-path="location.html"><a href="location.html#introduction-8"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="location.html"><a href="location.html#case-study"><i class="fa fa-check"></i><b>13.2</b> Case study: bike shops in Germany</a></li>
<li class="chapter" data-level="13.3" data-path="location.html"><a href="location.html#tidy-the-input-data"><i class="fa fa-check"></i><b>13.3</b> Tidy the input data</a></li>
<li class="chapter" data-level="13.4" data-path="location.html"><a href="location.html#create-census-rasters"><i class="fa fa-check"></i><b>13.4</b> Create census rasters</a></li>
<li class="chapter" data-level="13.5" data-path="location.html"><a href="location.html#define-metropolitan-areas"><i class="fa fa-check"></i><b>13.5</b> Define metropolitan areas</a></li>
<li class="chapter" data-level="13.6" data-path="location.html"><a href="location.html#points-of-interest"><i class="fa fa-check"></i><b>13.6</b> Points of interest</a></li>
<li class="chapter" data-level="13.7" data-path="location.html"><a href="location.html#identifying-suitable-locations"><i class="fa fa-check"></i><b>13.7</b> Identifying suitable locations</a></li>
<li class="chapter" data-level="13.8" data-path="location.html"><a href="location.html#discussion-and-next-steps"><i class="fa fa-check"></i><b>13.8</b> Discussion and next steps</a></li>
<li class="chapter" data-level="13.9" data-path="location.html"><a href="location.html#exercises-9"><i class="fa fa-check"></i><b>13.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="eco.html"><a href="eco.html"><i class="fa fa-check"></i><b>14</b> Ecology</a><ul>
<li class="chapter" data-level="" data-path="eco.html"><a href="eco.html#prerequisites-12"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="14.1" data-path="eco.html"><a href="eco.html#introduction-9"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="eco.html"><a href="eco.html#data-and-data-preparation"><i class="fa fa-check"></i><b>14.2</b> Data and data preparation</a></li>
<li class="chapter" data-level="14.3" data-path="eco.html"><a href="eco.html#nmds"><i class="fa fa-check"></i><b>14.3</b> Reducing dimensionality</a></li>
<li class="chapter" data-level="14.4" data-path="eco.html"><a href="eco.html#modeling-the-floristic-gradient"><i class="fa fa-check"></i><b>14.4</b> Modeling the floristic gradient</a><ul>
<li class="chapter" data-level="14.4.1" data-path="eco.html"><a href="eco.html#mlr-building-blocks"><i class="fa fa-check"></i><b>14.4.1</b> <strong>mlr</strong> building blocks</a></li>
<li class="chapter" data-level="14.4.2" data-path="eco.html"><a href="eco.html#predictive-mapping"><i class="fa fa-check"></i><b>14.4.2</b> Predictive mapping</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="eco.html"><a href="eco.html#conclusions-1"><i class="fa fa-check"></i><b>14.5</b> Conclusions</a></li>
<li class="chapter" data-level="14.6" data-path="eco.html"><a href="eco.html#exercises-10"><i class="fa fa-check"></i><b>14.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>15</b> Conclusion</a><ul>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html#prerequisites-13"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="15.1" data-path="conclusion.html"><a href="conclusion.html#introduction-10"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="conclusion.html"><a href="conclusion.html#package-choice"><i class="fa fa-check"></i><b>15.2</b> Package choice</a></li>
<li class="chapter" data-level="15.3" data-path="conclusion.html"><a href="conclusion.html#gaps"><i class="fa fa-check"></i><b>15.3</b> Gaps and overlaps</a></li>
<li class="chapter" data-level="15.4" data-path="conclusion.html"><a href="conclusion.html#next"><i class="fa fa-check"></i><b>15.4</b> Where to go next?</a></li>
<li class="chapter" data-level="15.5" data-path="conclusion.html"><a href="conclusion.html#benefit"><i class="fa fa-check"></i><b>15.5</b> The open source approach</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://robinlovelace.net/">Robin Lovelace</a></li>
<li><a href="https://nowosad.github.io/">Jakub Nowosad</a></li>
<li><a href="https://github.com/jannes-m/">Jannes Muenchow</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Geocomputation with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="gis" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Bridges to GIS software</h1>
<div id="prerequisites-7" class="section level2 unnumbered">
<h2>Prerequisites</h2>
<ul>
<li>This chapter requires QGIS, SAGA and GRASS to be installed and the following packages to be attached:<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a></li>
</ul>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="gis.html#cb305-1"></a><span class="kw">library</span>(sf)</span>
<span id="cb305-2"><a href="gis.html#cb305-2"></a><span class="kw">library</span>(raster)</span></code></pre></div>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="gis.html#cb306-1"></a><span class="kw">library</span>(RQGIS)</span>
<span id="cb306-2"><a href="gis.html#cb306-2"></a><span class="kw">library</span>(RSAGA)</span>
<span id="cb306-3"><a href="gis.html#cb306-3"></a><span class="kw">library</span>(rgrass7)</span></code></pre></div>
</div>
<div id="introduction-6" class="section level2">
<h2><span class="header-section-number">9.1</span> Introduction</h2>
<p>A defining feature of R is the way you interact with it:
you type commands and hit <code>Enter</code> (or <code>Ctrl+Enter</code> if writing code in the source editor in RStudio) to execute them interactively.
This way of interacting with the computer is called a command-line interface (CLI) (see definition in the note below).
CLIs are not unique to R.<a href="#fn41" class="footnote-ref" id="fnref41"><sup>41</sup></a>
In dedicated GIS packages, by contrast, the emphasis tends to be on the graphical user interface (GUI).
You <em>can</em> interact with GRASS, QGIS, SAGA and gvSIG from system terminals and embedded CLIs such as the <a href="https://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/intro.html">Python Console in QGIS</a>, but ‘pointing and clicking’ is the norm.
This means many GIS users miss out on the advantages of the command-line according to Gary Sherman, creator of QGIS <span class="citation">(Sherman <a href="#ref-sherman_desktop_2008" role="doc-biblioref">2008</a>)</span>:</p>
<blockquote>
<p>With the advent of ‘modern’ GIS software, most people want to point and
click their way through life. That’s good, but there is a tremendous amount
of flexibility and power waiting for you with the command line. Many times
you can do something on the command line in a fraction of the time you
can do it with a GUI.</p>
</blockquote>
<p>The ‘CLI vs GUI’ debate can be adversial but it does not have to be; both options can be used interchangeably, depending on the task at hand and the user’s skillset.<a href="#fn42" class="footnote-ref" id="fnref42"><sup>42</sup></a>
The advantages of a good CLI such as that provided by R (and enhanced by IDEs such as RStudio) are numerous.
A good CLI</p>
<ul>
<li>facilitates the automation of repetitive tasks;</li>
<li>enables transparency and reproducibility, the backbone of good scientific practice and data science;</li>
<li>encourages software development by providing tools to modify existing functions and implement new ones;</li>
<li>helps develop future-proof programming skills which are in high demand in many disciplines and industries; and</li>
<li>is user-friendly and fast, allowing an efficient workflow.</li>
</ul>
<p>On the other hand, GUI-based GIS systems (particularly QGIS) are also advantageous.
A good GIS GUI</p>
<ul>
<li>has a ‘shallow’ learning curve meaning geographic data can be explored and visualized without hours of learning a new language;</li>
<li>provides excellent support for ‘digitizing’ (creating new vector datasets), including trace, snap and topological tools;<a href="#fn43" class="footnote-ref" id="fnref43"><sup>43</sup></a></li>
<li>enables georeferencing (matching raster images to existing maps) with ground control points and orthorectification;
<!-- The process of locating control points, choosing the right transformation model, and evaluating the registration error are inherently interactive, and thus unsuitable to be done with R, or any other programming language; --></li>
<li>supports stereoscopic mapping (e.g., LiDAR and structure from motion); and</li>
<li>provides access to spatial database management systems with object-oriented relational data models, topology and fast (spatial) querying.</li>
</ul>
<p>Another advantage of dedicated GISs is that they provide access to hundreds of ‘geoalgorithms’ (computational recipes to solve geographic problems — see Chapter <a href="algorithms.html#algorithms">10</a>).
Many of these are unavailable from the R command line, except via ‘GIS bridges’, the topic of (and motivation for) this chapter.<a href="#fn44" class="footnote-ref" id="fnref44"><sup>44</sup></a></p>

<div class="rmdnote">
A command-line interface is a means of interacting with computer programs in which the user issues commands via successive lines of text (command lines).
<code>bash</code> in Linux and <code>PowerShell</code> in Windows are common examples.
CLIs can be augmented with IDEs such as RStudio for R, which provides code auto-completion and other features to improve the user experience.
</div>

<p>R originated as an interface language.
Its predecessor S provided access to statistical algorithms in other languages (particularly FORTRAN), but from an intuitive read-evaluate-print loop (REPL) <span class="citation">(Chambers <a href="#ref-chambers_extending_2016" role="doc-biblioref">2016</a>)</span>.
R continues this tradition with interfaces to numerous languages, notably C++, as described in Chapter <a href="intro.html#intro">1</a>.
R was not designed as a GIS.
However, its ability to interface with dedicated GISs gives it astonishing geospatial capabilities.
R is well known as a statistical programming language, but many people are unaware of its ability to replicate GIS workflows, with the additional benefits of a (relatively) consistent CLI.
Furthermore, R outperforms GISs in some areas of geocomputation, including interactive/animated map making (see Chapter <a href="adv-map.html#adv-map">8</a>) and spatial statistical modeling (see Chapter <a href="spatial-cv.html#spatial-cv">11</a>).
<!-- Instead of implementing existing GIS algorithms in R, it makes sense to avoid 'reinventing the wheel' by taking advantage of R's ability to interface with other languages (especially C++, which is used for much low-level and high-performance GIS work). -->
<!-- Using compiled code for new geoprocessing functionality (particularly with the help of the excellent **Rcpp** package) could form the basis of new R packages, building on the success of **sf** [@pebesma_simple_2018]. -->
<!-- However, there are already a wide range of algorithms that can be accessed via R's interfaces to dedicated GIS software. -->
<!-- It makes sense to understand these before moving to develop your own optimized algorithms. -->
This chapter focuses on ‘bridges’ to three mature open source GIS products (see Table <a href="gis.html#tab:gis-comp">9.1</a>): QGIS (via the package <strong>RQGIS</strong>; Section <a href="gis.html#rqgis">9.2</a>), SAGA (via <strong>RSAGA</strong>; Section <a href="gis.html#rsaga">9.3</a>) and GRASS (via <strong>rgrass7</strong>; Section <a href="gis.html#rgrass">9.4</a>).
Though not covered here, it is worth being aware of the interface to ArcGIS, a proprietary and very popular GIS software, via <strong>RPyGeo</strong>.<a href="#fn45" class="footnote-ref" id="fnref45"><sup>45</sup></a>
To complement the R-GIS bridges, the chapter ends with a very brief introduction to interfaces to spatial libraries (Section <a href="gis.html#gdal">9.6.1</a>) and spatial databases (Section <a href="gis.html#postgis">9.6.2</a>).</p>
<!-- The chapter's aim is to provide working knowledge of R's bridges to open source GISs. -->
<!-- As mentioned in Chapter \@ref(intro), doing GIS at the command-line makes it more reproducible, in-line with the principles of Geographic Data Science. -->
<table>
<caption><span id="tab:gis-comp">TABLE 9.1: </span>Comparison between three open-source GIS. Hybrid refers to the support of vector and raster operations.</caption>
<thead>
<tr class="header">
<th align="left">GIS</th>
<th align="left">First release</th>
<th align="left">No. functions</th>
<th align="left">Support</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GRASS</td>
<td align="left">1984</td>
<td align="left">&gt;500</td>
<td align="left">hybrid</td>
</tr>
<tr class="even">
<td align="left">QGIS</td>
<td align="left">2002</td>
<td align="left">&gt;1000</td>
<td align="left">hybrid</td>
</tr>
<tr class="odd">
<td align="left">SAGA</td>
<td align="left">2004</td>
<td align="left">&gt;600</td>
<td align="left">hybrid</td>
</tr>
</tbody>
</table>
</div>
<div id="rqgis" class="section level2">
<h2><span class="header-section-number">9.2</span> (R)QGIS</h2>
<p>QGIS is one of the most popular open-source GIS <span class="citation">(Table <a href="gis.html#tab:gis-comp">9.1</a>; Graser and Olaya <a href="#ref-graser_processing_2015" role="doc-biblioref">2015</a>)</span>.
Its main advantage lies in the fact that it provides a unified interface to several other open-source GIS.
This means that you have access to GDAL, GRASS and SAGA through QGIS <span class="citation">(Graser and Olaya <a href="#ref-graser_processing_2015" role="doc-biblioref">2015</a>)</span>.
To run all these geoalgorithms (frequently more than 1000 depending on your set-up) outside of the QGIS GUI, QGIS provides a Python API.
<strong>RQGIS</strong> establishes a tunnel to this Python API through the <strong>reticulate</strong> package.
Basically, functions <code>set_env()</code> and <code>open_app()</code> are doing this.
Note that it is optional to run <code>set_env()</code> and <code>open_app()</code> since all functions depending on their output will run them automatically if needed.
Before running <strong>RQGIS</strong>, make sure you have installed QGIS and all its (third-party) dependencies such as SAGA and GRASS.
To install <strong>RQGIS</strong> a number of dependencies are required, as described in the <a href="https://cran.r-project.org/web/packages/RQGIS/vignettes/install_guide.html"><code>install_guide</code></a> vignette, which covers installation on Windows, Linux and Mac.
At the time of writing (autumn 2018) RQGIS only supports the <a href="https://qgis.org/en/site/getinvolved/development/roadmap.html">Long Term Release</a> (2.18), but support for QGIS 3 is in the pipeline (see <a href="https://github.com/jannes-m/RQGIS3">RQGIS3</a>).</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="gis.html#cb307-1"></a><span class="kw">library</span>(RQGIS)</span>
<span id="cb307-2"><a href="gis.html#cb307-2"></a><span class="kw">set_env</span>(<span class="dt">dev =</span> <span class="ot">FALSE</span>)</span>
<span id="cb307-3"><a href="gis.html#cb307-3"></a><span class="co">#&gt; $`root`</span></span>
<span id="cb307-4"><a href="gis.html#cb307-4"></a><span class="co">#&gt; [1] &quot;C:/OSGeo4W64&quot;</span></span>
<span id="cb307-5"><a href="gis.html#cb307-5"></a><span class="co">#&gt; ...</span></span></code></pre></div>
<p>Leaving the <code>path</code>-argument of <code>set_env()</code> unspecified will search the computer for a QGIS installation.
Hence, it is faster to specify explicitly the path to your QGIS installation.
Subsequently, <code>open_app()</code> sets all paths necessary to run QGIS from within R, and finally creates a so-called QGIS custom application (see <a href="http://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/intro.html#using-pyqgis-in-custom-applications">http://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/intro.html#using-pyqgis-in-custom-applications</a>).</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="gis.html#cb308-1"></a><span class="kw">open_app</span>()</span></code></pre></div>
<p>We are now ready for some QGIS geoprocessing from within R!
The example below shows how to unite polygons, a process that unfortunately produces so-called slivers , tiny polygons resulting from overlaps between the inputs that frequently occur in real-world data.
We will see how to remove them.</p>
<p>For the union, we use again the incongruent polygons we have already encountered in Section <a href="spatial-operations.html#spatial-aggr">4.2.5</a>.
Both polygon datasets are available in the <strong>spData</strong> package, and for both we would like to use a geographic CRS (see also Chapter <a href="reproj-geo-data.html#reproj-geo-data">6</a>).</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="gis.html#cb309-1"></a><span class="kw">data</span>(<span class="st">&quot;incongruent&quot;</span>, <span class="st">&quot;aggregating_zones&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;spData&quot;</span>)</span>
<span id="cb309-2"><a href="gis.html#cb309-2"></a>incongr_wgs =<span class="st"> </span><span class="kw">st_transform</span>(incongruent, <span class="dv">4326</span>)</span>
<span id="cb309-3"><a href="gis.html#cb309-3"></a>aggzone_wgs =<span class="st"> </span><span class="kw">st_transform</span>(aggregating_zones, <span class="dv">4326</span>)</span></code></pre></div>
<p>To find an algorithm to do this work, <code>find_algorithms()</code> searches all QGIS geoalgorithms using regular expressions.
Assuming that the short description of the function contains the word “union”, we can run:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="gis.html#cb310-1"></a><span class="kw">find_algorithms</span>(<span class="st">&quot;union&quot;</span>, <span class="dt">name_only =</span> <span class="ot">TRUE</span>)</span>
<span id="cb310-2"><a href="gis.html#cb310-2"></a><span class="co">#&gt; [1] &quot;qgis:union&quot;        &quot;saga:fuzzyunionor&quot; &quot;saga:union&quot;</span></span></code></pre></div>
<p>Short descriptions for each geoalgorithm can also be provided, by setting <code>name_only = FALSE</code>.
If one has no clue at all what the name of a geoalgorithm might be, one can leave the <code>search_term</code>-argument empty which will return a list of all available QGIS geoalgorithms.
You can also find the algorithms in the <a href="https://docs.qgis.org/2.18/en/docs/user_manual/processing_algs/index.html">QGIS online documentation</a>.</p>
<p>The next step is to find out how <code>qgis:union</code> can be used.
<code>open_help()</code> opens the online help of the geoalgorithm in question.
<code>get_usage()</code> returns all function parameters and default values.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="gis.html#cb311-1"></a>alg =<span class="st"> &quot;qgis:union&quot;</span></span>
<span id="cb311-2"><a href="gis.html#cb311-2"></a><span class="kw">open_help</span>(alg)</span>
<span id="cb311-3"><a href="gis.html#cb311-3"></a><span class="kw">get_usage</span>(alg)</span>
<span id="cb311-4"><a href="gis.html#cb311-4"></a><span class="co">#&gt;ALGORITHM: Union</span></span>
<span id="cb311-5"><a href="gis.html#cb311-5"></a><span class="co">#&gt;  INPUT &lt;ParameterVector&gt;</span></span>
<span id="cb311-6"><a href="gis.html#cb311-6"></a><span class="co">#&gt;  INPUT2 &lt;ParameterVector&gt;</span></span>
<span id="cb311-7"><a href="gis.html#cb311-7"></a><span class="co">#&gt;  OUTPUT &lt;OutputVector&gt;</span></span></code></pre></div>
<p>Finally, we can let QGIS do the work.
Note that the workhorse function <code>run_qgis()</code> accepts R named arguments, i.e., you can specify the parameter names as returned by <code>get_usage()</code> in <code>run_qgis()</code> as you would do in any other regular R function.
Note also that <code>run_qgis()</code> accepts spatial objects residing in R’s global environment as input (here: <code>aggzone_wgs</code> and <code>incongr_wgs</code>).
But of course, you could also specify paths to spatial vector files stored on disk.
Setting the <code>load_output</code> to <code>TRUE</code> automatically loads the QGIS output as an <strong>sf</strong>-object into R.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="gis.html#cb312-1"></a>union =<span class="st"> </span><span class="kw">run_qgis</span>(alg, <span class="dt">INPUT =</span> incongr_wgs, <span class="dt">INPUT2 =</span> aggzone_wgs, </span>
<span id="cb312-2"><a href="gis.html#cb312-2"></a>                 <span class="dt">OUTPUT =</span> <span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;union.shp&quot;</span>),</span>
<span id="cb312-3"><a href="gis.html#cb312-3"></a>                 <span class="dt">load_output =</span> <span class="ot">TRUE</span>)</span>
<span id="cb312-4"><a href="gis.html#cb312-4"></a><span class="co">#&gt; $`OUTPUT`</span></span>
<span id="cb312-5"><a href="gis.html#cb312-5"></a><span class="co">#&gt; [1] &quot;C:/Users/geocompr/AppData/Local/Temp/RtmpcJlnUx/union.shp&quot;</span></span></code></pre></div>
<p>Note that the QGIS union operation merges the two input layers into one layer by using the intersection and the symmetrical difference of the two input layers (which by the way is also the default when doing a union operation in GRASS and SAGA).
This is <strong>not</strong> the same as <code>st_union(incongr_wgs, aggzone_wgs)</code> (see Exercises)!
The QGIS output contains empty geometries and multipart polygons.
Empty geometries might lead to problems in subsequent geoprocessing tasks which is why they will be deleted.
<code>st_dimension()</code> returns <code>NA</code> if a geometry is empty, and can therefore be used as a filter.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="gis.html#cb313-1"></a><span class="co"># remove empty geometries</span></span>
<span id="cb313-2"><a href="gis.html#cb313-2"></a>union =<span class="st"> </span>union[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">st_dimension</span>(union)), ]</span></code></pre></div>
<p>Next we convert multipart polygons into single-part polygons (also known as explode geometries or casting).
This is necessary for the deletion of sliver polygons later on.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="gis.html#cb314-1"></a><span class="co"># multipart polygons to single polygons</span></span>
<span id="cb314-2"><a href="gis.html#cb314-2"></a>single =<span class="st"> </span><span class="kw">st_cast</span>(union, <span class="st">&quot;POLYGON&quot;</span>)</span></code></pre></div>
<p>One way to identify slivers is to find polygons with comparatively very small areas, here, e.g., 25000 m<sup>2</sup> (see blue colored polygons in the left panel of Figure <a href="gis.html#fig:sliver-fig">9.1</a>).</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="gis.html#cb315-1"></a><span class="co"># find polygons which are smaller than 25000 m^2</span></span>
<span id="cb315-2"><a href="gis.html#cb315-2"></a>x =<span class="st"> </span><span class="dv">25000</span></span>
<span id="cb315-3"><a href="gis.html#cb315-3"></a><span class="kw">units</span>(x) =<span class="st"> &quot;m^2&quot;</span></span>
<span id="cb315-4"><a href="gis.html#cb315-4"></a>single<span class="op">$</span>area =<span class="st"> </span><span class="kw">st_area</span>(single)</span>
<span id="cb315-5"><a href="gis.html#cb315-5"></a>sub =<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(single, area <span class="op">&lt;</span><span class="st"> </span>x)</span></code></pre></div>
<p>The next step is to find a function that makes the slivers disappear.
Assuming the function or its short description contains the word “sliver”, we can run:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="gis.html#cb316-1"></a><span class="kw">find_algorithms</span>(<span class="st">&quot;sliver&quot;</span>, <span class="dt">name_only =</span> <span class="ot">TRUE</span>)</span>
<span id="cb316-2"><a href="gis.html#cb316-2"></a><span class="co">#&gt; [1] &quot;qgis:eliminatesliverpolygons&quot;</span></span></code></pre></div>
<p>This returns only one geoalgorithm whose parameters can be accessed with the help of <code>get_usage()</code> again.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="gis.html#cb317-1"></a>alg =<span class="st"> &quot;qgis:eliminatesliverpolygons&quot;</span></span>
<span id="cb317-2"><a href="gis.html#cb317-2"></a><span class="kw">get_usage</span>(alg)</span>
<span id="cb317-3"><a href="gis.html#cb317-3"></a><span class="co">#&gt;ALGORITHM: Eliminate sliver polygons</span></span>
<span id="cb317-4"><a href="gis.html#cb317-4"></a><span class="co">#&gt;  INPUT &lt;ParameterVector&gt;</span></span>
<span id="cb317-5"><a href="gis.html#cb317-5"></a><span class="co">#&gt;  KEEPSELECTION &lt;ParameterBoolean&gt;</span></span>
<span id="cb317-6"><a href="gis.html#cb317-6"></a><span class="co">#&gt;  ATTRIBUTE &lt;parameters from INPUT&gt;</span></span>
<span id="cb317-7"><a href="gis.html#cb317-7"></a><span class="co">#&gt;  COMPARISON &lt;ParameterSelection&gt;</span></span>
<span id="cb317-8"><a href="gis.html#cb317-8"></a><span class="co">#&gt;  COMPARISONVALUE &lt;ParameterString&gt;</span></span>
<span id="cb317-9"><a href="gis.html#cb317-9"></a><span class="co">#&gt;  MODE &lt;ParameterSelection&gt;</span></span>
<span id="cb317-10"><a href="gis.html#cb317-10"></a><span class="co">#&gt;  OUTPUT &lt;OutputVector&gt;</span></span>
<span id="cb317-11"><a href="gis.html#cb317-11"></a><span class="co">#&gt;  ...</span></span></code></pre></div>
<p></p>
<p>Conveniently, the user does not need to specify each single parameter.
In case a parameter is left unspecified, <code>run_qgis()</code> will automatically use the corresponding default value as an argument if available.
To find out about the default values, run <code>get_args_man()</code>.</p>
<p>To remove the slivers, we specify that all polygons with an area less or equal to 25,000 m<sup>2</sup> should be joined to the neighboring polygon with the largest area (see right panel of Figure <a href="gis.html#fig:sliver-fig">9.1</a>).</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="gis.html#cb318-1"></a>clean =<span class="st"> </span><span class="kw">run_qgis</span>(<span class="st">&quot;qgis:eliminatesliverpolygons&quot;</span>,</span>
<span id="cb318-2"><a href="gis.html#cb318-2"></a>                 <span class="dt">INPUT =</span> single,</span>
<span id="cb318-3"><a href="gis.html#cb318-3"></a>                 <span class="dt">ATTRIBUTE =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb318-4"><a href="gis.html#cb318-4"></a>                 <span class="dt">COMPARISON =</span> <span class="st">&quot;&lt;=&quot;</span>,</span>
<span id="cb318-5"><a href="gis.html#cb318-5"></a>                 <span class="dt">COMPARISONVALUE =</span> <span class="dv">25000</span>,</span>
<span id="cb318-6"><a href="gis.html#cb318-6"></a>                 <span class="dt">OUTPUT =</span> <span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;clean.shp&quot;</span>),</span>
<span id="cb318-7"><a href="gis.html#cb318-7"></a>                 <span class="dt">load_output =</span> <span class="ot">TRUE</span>)</span>
<span id="cb318-8"><a href="gis.html#cb318-8"></a><span class="co">#&gt; $`OUTPUT`</span></span>
<span id="cb318-9"><a href="gis.html#cb318-9"></a><span class="co">#&gt; [1] &quot;C:/Users/geocompr/AppData/Local/Temp/RtmpcJlnUx/clean.shp&quot;</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sliver-fig"></span>
<img src="figures/09_sliver.png" alt="Sliver polygons colored in blue (left panel). Cleaned polygons (right panel)." width="100%" />
<p class="caption">
FIGURE 9.1: Sliver polygons colored in blue (left panel). Cleaned polygons (right panel).
</p>
</div>
<p>In the code chunk above note that</p>
<ul>
<li>leaving the output parameter(s) unspecified saves the resulting QGIS output to a temporary folder created by QGIS;
<code>run_qgis()</code> prints these paths to the console after successfully running the QGIS engine; and</li>
<li>if the output consists of multiple files and you have set <code>load_output</code> to <code>TRUE</code>, <code>run_qgis()</code> will return a list with each element corresponding to one output file.</li>
</ul>
<p>To learn more about <strong>RQGIS</strong>, see <span class="citation">Muenchow, Schratz, and Brenning (<a href="#ref-muenchow_rqgis:_2017" role="doc-biblioref">2017</a>)</span>.</p>
</div>
<div id="rsaga" class="section level2">
<h2><span class="header-section-number">9.3</span> (R)SAGA</h2>
<p>The System for Automated Geoscientific Analyses (SAGA; Table <a href="gis.html#tab:gis-comp">9.1</a>) provides the possibility to execute SAGA modules via the command line interface (<code>saga_cmd.exe</code> under Windows and just <code>saga_cmd</code> under Linux) (see the <a href="https://sourceforge.net/p/saga-gis/wiki/Executing%20Modules%20with%20SAGA%20CMD/">SAGA wiki on modules</a>).
In addition, there is a Python interface (SAGA Python API).
<strong>RSAGA</strong> uses the former to run SAGA from within R.</p>
<p>Though SAGA is a hybrid GIS, its main focus has been on raster processing, and here particularly on digital elevation models (soil properties, terrain attributes, climate parameters).
Hence, SAGA is especially good at the fast processing of large (high-resolution) raster datasets <span class="citation">(Conrad et al. <a href="#ref-conrad_system_2015" role="doc-biblioref">2015</a>)</span>.
Therefore, we will introduce <strong>RSAGA</strong> with a raster use case from <span class="citation">Muenchow, Brenning, and Richter (<a href="#ref-muenchow_geomorphic_2012" role="doc-biblioref">2012</a>)</span>.
Specifically, we would like to compute the SAGA wetness index from a digital elevation model.
First of all, we need to make sure that <strong>RSAGA</strong> will find SAGA on the computer when called.
For this, all <strong>RSAGA</strong> functions using SAGA in the background make use of <code>rsaga.env()</code>.
Usually, <code>rsaga.env()</code> will detect SAGA automatically by searching several likely directories (see its help for more information).</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="gis.html#cb319-1"></a><span class="kw">library</span>(RSAGA)</span>
<span id="cb319-2"><a href="gis.html#cb319-2"></a><span class="kw">rsaga.env</span>()</span>
<span id="cb319-3"><a href="gis.html#cb319-3"></a><span class="co">#&gt; Search for SAGA command line program and modules... </span></span>
<span id="cb319-4"><a href="gis.html#cb319-4"></a><span class="co">#&gt; Done</span></span>
<span id="cb319-5"><a href="gis.html#cb319-5"></a><span class="co">#&gt; $workspace</span></span>
<span id="cb319-6"><a href="gis.html#cb319-6"></a><span class="co">#&gt; [1] &quot;.&quot;</span></span>
<span id="cb319-7"><a href="gis.html#cb319-7"></a><span class="co">#&gt; ...</span></span></code></pre></div>
<p>However, it is possible to have ‘hidden’ SAGA in a location <code>rsaga.env()</code> does not search automatically.
<code>linkSAGA</code> searches your computer for a valid SAGA installation.
If it finds one, it adds the newest version to the PATH environment variable thereby making sure that <code>rsaga.env()</code> runs successfully.
It is only necessary to run the next code chunk if <code>rsaga.env()</code> was unsuccessful (see previous code chunk).</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="gis.html#cb320-1"></a><span class="kw">library</span>(link2GI)</span>
<span id="cb320-2"><a href="gis.html#cb320-2"></a>saga =<span class="st"> </span><span class="kw">linkSAGA</span>()</span>
<span id="cb320-3"><a href="gis.html#cb320-3"></a><span class="kw">rsaga.env</span>()</span></code></pre></div>
<p>Secondly, we need to write the digital elevation model to a SAGA-format.
Note that calling <code>data(landslides)</code> attaches two objects to the global environment - <code>dem</code>, a digital elevation model in the form of a <code>list</code>, and <code>landslides</code>, a <code>data.frame</code> containing observations representing the presence or absence of a landslide:</p>
<!-- The following examples only work with SAGA < 2.3. We have informed the package maintainer to update SAGA -->
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="gis.html#cb321-1"></a><span class="kw">data</span>(landslides)</span>
<span id="cb321-2"><a href="gis.html#cb321-2"></a><span class="kw">write.sgrd</span>(<span class="dt">data =</span> dem, <span class="dt">file =</span> <span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;dem&quot;</span>), <span class="dt">header =</span> dem<span class="op">$</span>header)</span></code></pre></div>
<p>The organization of SAGA is modular.
Libraries contain so-called modules, i.e., geoalgorithms.
To find out which libraries are available, run (output not shown):</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="gis.html#cb322-1"></a><span class="kw">rsaga.get.libraries</span>()</span></code></pre></div>
<p>We choose the library <code>ta_hydrology</code> (<code>ta</code> is the abbreviation for terrain analysis).
Subsequently, we can access the available modules of a specific library (here: <code>ta_hydrology</code>) as follows:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="gis.html#cb323-1"></a><span class="kw">rsaga.get.modules</span>(<span class="dt">libs =</span> <span class="st">&quot;ta_hydrology&quot;</span>)</span></code></pre></div>
<p><code>rsaga.get.usage()</code> prints the function parameters of a specific geoalgorithm, e.g., the <code>SAGA Wetness Index</code>, to the console.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="gis.html#cb324-1"></a><span class="kw">rsaga.get.usage</span>(<span class="dt">lib =</span> <span class="st">&quot;ta_hydrology&quot;</span>, <span class="dt">module =</span> <span class="st">&quot;SAGA Wetness Index&quot;</span>)</span></code></pre></div>
<p>Finally, you can run SAGA from within R using <strong>RSAGA</strong>’s geoprocessing workhorse function <code>rsaga.geoprocessor()</code>.
The function expects a parameter-argument list in which you have specified all necessary parameters.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="gis.html#cb325-1"></a>params =<span class="st"> </span><span class="kw">list</span>(<span class="dt">DEM =</span> <span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;dem.sgrd&quot;</span>),</span>
<span id="cb325-2"><a href="gis.html#cb325-2"></a>              <span class="dt">TWI =</span> <span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;twi.sdat&quot;</span>))</span>
<span id="cb325-3"><a href="gis.html#cb325-3"></a><span class="kw">rsaga.geoprocessor</span>(<span class="dt">lib =</span> <span class="st">&quot;ta_hydrology&quot;</span>, <span class="dt">module =</span> <span class="st">&quot;SAGA Wetness Index&quot;</span>, </span>
<span id="cb325-4"><a href="gis.html#cb325-4"></a>                   <span class="dt">param =</span> params)</span></code></pre></div>
<p>To facilitate the access to the SAGA interface, <strong>RSAGA</strong> frequently provides user-friendly wrapper-functions with meaningful default values (see <strong>RSAGA</strong> documentation for examples, e.g., <code>?rsaga.wetness.index</code>).
So the function call for calculating the ‘SAGA Wetness Index’ becomes:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="gis.html#cb326-1"></a><span class="kw">rsaga.wetness.index</span>(<span class="dt">in.dem =</span> <span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;dem&quot;</span>), </span>
<span id="cb326-2"><a href="gis.html#cb326-2"></a>                    <span class="dt">out.wetness.index =</span> <span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;twi&quot;</span>))</span></code></pre></div>
<p>Of course, we would like to inspect our result visually (Figure <a href="gis.html#fig:saga-twi">9.2</a>).
To load and plot the SAGA output file, we use the <strong>raster</strong> package.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="gis.html#cb327-1"></a><span class="kw">library</span>(raster)</span>
<span id="cb327-2"><a href="gis.html#cb327-2"></a>twi =<span class="st"> </span>raster<span class="op">::</span><span class="kw">raster</span>(<span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;twi.sdat&quot;</span>))</span>
<span id="cb327-3"><a href="gis.html#cb327-3"></a><span class="co"># shown is a version using tmap</span></span>
<span id="cb327-4"><a href="gis.html#cb327-4"></a><span class="kw">plot</span>(twi, <span class="dt">col =</span> RColorBrewer<span class="op">::</span><span class="kw">brewer.pal</span>(<span class="dt">n =</span> <span class="dv">9</span>, <span class="dt">name =</span> <span class="st">&quot;Blues&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:saga-twi"></span>
<img src="figures/09_twi.png" alt="SAGA wetness index of Mount Mongón, Peru." width="50%" />
<p class="caption">
FIGURE 9.2: SAGA wetness index of Mount Mongón, Peru.
</p>
</div>
<p>You can find an extended version of this example in <code>vignette("RSAGA-landslides")</code> which includes the use of statistical geocomputing to derive terrain attributes as predictors for a non-linear Generalized Additive Model (GAM) to predict spatially landslide susceptibility <span class="citation">(Muenchow, Brenning, and Richter <a href="#ref-muenchow_geomorphic_2012" role="doc-biblioref">2012</a>)</span>.
The term statistical geocomputation emphasizes the strength of combining R’s data science power with the geoprocessing power of a GIS which is at the very heart of building a bridge from R to GIS.</p>
</div>
<div id="rgrass" class="section level2">
<h2><span class="header-section-number">9.4</span> GRASS through <strong>rgrass7</strong></h2>
<p>The U.S. Army - Construction Engineering Research Laboratory (USA-CERL) created the core of the Geographical Resources Analysis Support System (GRASS) <span class="citation">(Table <a href="gis.html#tab:gis-comp">9.1</a>; Neteler and Mitasova <a href="#ref-neteler_open_2008" role="doc-biblioref">2008</a>)</span> from 1982 to 1995.
Academia continued this work since 1997.
Similar to SAGA, GRASS focused on raster processing in the beginning while only later, since GRASS 6.0, adding advanced vector functionality <span class="citation">(Bivand, Pebesma, and Gómez-Rubio <a href="#ref-bivand_applied_2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>We will introduce <strong>rgrass7</strong> with one of the most interesting problems in GIScience - the traveling salesman problem.
Suppose a traveling salesman would like to visit 24 customers.
Additionally, he would like to start and finish his journey at home which makes a total of 25 locations while covering the shortest distance possible.
There is a single best solution to this problem; however, to find it is even for modern computers (mostly) impossible <span class="citation">(Longley <a href="#ref-longley_geographic_2015" role="doc-biblioref">2015</a>)</span>.
In our case, the number of possible solutions correspond to <code>(25 - 1)! / 2</code>, i.e., the factorial of 24 divided by 2 (since we do not differentiate between forward or backward direction).
Even if one iteration can be done in a nanosecond, this still corresponds to 9837145 years.
Luckily, there are clever, almost optimal solutions which run in a tiny fraction of this inconceivable amount of time.
GRASS GIS provides one of these solutions (for more details, see <a href="https://grass.osgeo.org/grass77/manuals/v.net.salesman.html">v.net.salesman</a>).
In our use case, we would like to find the shortest path between the first 25 bicycle stations (instead of customers) on London’s streets (and we simply assume that the first bike station corresponds to the home of our traveling salesman).</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="gis.html#cb328-1"></a><span class="kw">data</span>(<span class="st">&quot;cycle_hire&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;spData&quot;</span>)</span>
<span id="cb328-2"><a href="gis.html#cb328-2"></a>points =<span class="st"> </span>cycle_hire[<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>, ]</span></code></pre></div>
<p>Aside from the cycle hire points data, we will need the OpenStreetMap data of London.
We download it with the help of the <strong>osmdata</strong> package (see also Section <a href="read-write.html#retrieving-data">7.2</a>).
We constrain the download of the street network (in OSM language called “highway”) to the bounding box of the cycle hire data, and attach the corresponding data as an <code>sf</code>-object.
<code>osmdata_sf()</code> returns a list with several spatial objects (points, lines, polygons, etc.).
Here, we will only keep the line objects.
OpenStreetMap objects come with a lot of columns, <code>streets</code> features almost 500.
In fact, we are only interested in the geometry column.
Nevertheless, we are keeping one attribute column; otherwise, we will run into trouble when trying to provide <code>writeVECT()</code> only with a geometry object (see further below and <code>?writeVECT</code> for more details).
Remember that the geometry column is sticky, hence, even though we are just selecting one attribute, the geometry column will be also returned (see Section <a href="spatial-class.html#intro-sf">2.2.1</a>).
<!-- To learn more about how to use the **osmdata**-package, please refer to [https://ropensci.github.io/osmdata/](https://ropensci.github.io/osmdata/). --></p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="gis.html#cb329-1"></a><span class="kw">library</span>(osmdata)</span>
<span id="cb329-2"><a href="gis.html#cb329-2"></a>b_box =<span class="st"> </span><span class="kw">st_bbox</span>(points)</span>
<span id="cb329-3"><a href="gis.html#cb329-3"></a>london_streets =<span class="st"> </span><span class="kw">opq</span>(b_box) <span class="op">%&gt;%</span></span>
<span id="cb329-4"><a href="gis.html#cb329-4"></a><span class="st">  </span><span class="kw">add_osm_feature</span>(<span class="dt">key =</span> <span class="st">&quot;highway&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb329-5"><a href="gis.html#cb329-5"></a><span class="st">  </span><span class="kw">osmdata_sf</span>() <span class="op">%&gt;%</span></span>
<span id="cb329-6"><a href="gis.html#cb329-6"></a><span class="st">  `</span><span class="dt">[[</span><span class="st">`</span>(<span class="st">&quot;osm_lines&quot;</span>)</span>
<span id="cb329-7"><a href="gis.html#cb329-7"></a>london_streets =<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(london_streets, osm_id)</span></code></pre></div>
<p>As a convenience to the reader, one can attach <code>london_streets</code> to the global environment using <code>data("london_streets", package = "spDataLarge")</code>.</p>
<p>Now that we have the data, we can go on and initiate a GRASS session, i.e., we have to create a GRASS spatial database.
The GRASS geodatabase  system is based on SQLite.
Consequently, different users can easily work on the same project, possibly with different read/write permissions.
However, one has to set up this spatial database (also from within R), and users used to a GIS GUI popping up by one click might find this process a bit intimidating in the beginning.
First of all, the GRASS database requires its own directory, and contains a location (see the <a href="https://grass.osgeo.org/grass77/manuals/grass_database.html">GRASS GIS Database</a> help pages at <a href="https://grass.osgeo.org/grass77/manuals/index.html">grass.osgeo.org</a> for further information).
The location in turn simply contains the geodata for one project.
Within one location, several mapsets can exist and typically refer to different users.
PERMANENT is a mandatory mapset and is created automatically.
It stores the projection, the spatial extent and the default resolution for raster data.
In order to share geographic data with all users of a project, the database owner can add spatial data to the PERMANENT mapset.
Please refer to <span class="citation">Neteler and Mitasova (<a href="#ref-neteler_open_2008" role="doc-biblioref">2008</a>)</span> and the <a href="https://grass.osgeo.org/grass77/manuals/helptext.html">GRASS GIS quick start</a> for more information on the GRASS spatial database system.</p>
<p>You have to set up a location and a mapset if you want to use GRASS from within R.
First of all, we need to find out if and where GRASS 7 is installed on the computer.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="gis.html#cb330-1"></a><span class="kw">library</span>(link2GI)</span>
<span id="cb330-2"><a href="gis.html#cb330-2"></a>link =<span class="st"> </span><span class="kw">findGRASS</span>() </span></code></pre></div>
<p><code>link</code> is a <code>data.frame</code> which contains in its rows the GRASS 7 installations on your computer.
Here, we will use a GRASS 7 installation.
If you have not installed GRASS 7 on your computer, we recommend that you do so now.
Assuming that we have found a working installation on your computer, we use the corresponding path in <code>initGRASS</code>.
Additionally, we specify where to store the spatial database (gisDbase), name the location <code>london</code>, and use the PERMANENT mapset.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="gis.html#cb331-1"></a><span class="kw">library</span>(rgrass7)</span>
<span id="cb331-2"><a href="gis.html#cb331-2"></a><span class="co"># find a GRASS 7 installation, and use the first one</span></span>
<span id="cb331-3"><a href="gis.html#cb331-3"></a>ind =<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;7&quot;</span>, link<span class="op">$</span>version)[<span class="dv">1</span>]</span>
<span id="cb331-4"><a href="gis.html#cb331-4"></a><span class="co"># next line of code only necessary if we want to use GRASS as installed by </span></span>
<span id="cb331-5"><a href="gis.html#cb331-5"></a><span class="co"># OSGeo4W. Among others, this adds some paths to PATH, which are also needed</span></span>
<span id="cb331-6"><a href="gis.html#cb331-6"></a><span class="co"># for running GRASS.</span></span>
<span id="cb331-7"><a href="gis.html#cb331-7"></a>link2GI<span class="op">::</span><span class="kw">paramGRASSw</span>(link[ind, ])</span>
<span id="cb331-8"><a href="gis.html#cb331-8"></a>grass_path =<span class="st"> </span></span>
<span id="cb331-9"><a href="gis.html#cb331-9"></a><span class="st">  </span><span class="kw">ifelse</span>(<span class="dt">test =</span> <span class="op">!</span><span class="kw">is.null</span>(link<span class="op">$</span>installation_type) <span class="op">&amp;&amp;</span><span class="st"> </span></span>
<span id="cb331-10"><a href="gis.html#cb331-10"></a><span class="st">           </span>link<span class="op">$</span>installation_type[ind] <span class="op">==</span><span class="st"> &quot;osgeo4W&quot;</span>,</span>
<span id="cb331-11"><a href="gis.html#cb331-11"></a>         <span class="dt">yes =</span> <span class="kw">file.path</span>(link<span class="op">$</span>instDir[ind], <span class="st">&quot;apps/grass&quot;</span>, link<span class="op">$</span>version[ind]),</span>
<span id="cb331-12"><a href="gis.html#cb331-12"></a>         <span class="dt">no =</span> link<span class="op">$</span>instDir)</span>
<span id="cb331-13"><a href="gis.html#cb331-13"></a><span class="kw">initGRASS</span>(<span class="dt">gisBase =</span> grass_path,</span>
<span id="cb331-14"><a href="gis.html#cb331-14"></a>          <span class="co"># home parameter necessary under UNIX-based systems</span></span>
<span id="cb331-15"><a href="gis.html#cb331-15"></a>          <span class="dt">home =</span> <span class="kw">tempdir</span>(),</span>
<span id="cb331-16"><a href="gis.html#cb331-16"></a>          <span class="dt">gisDbase =</span> <span class="kw">tempdir</span>(), <span class="dt">location =</span> <span class="st">&quot;london&quot;</span>, </span>
<span id="cb331-17"><a href="gis.html#cb331-17"></a>          <span class="dt">mapset =</span> <span class="st">&quot;PERMANENT&quot;</span>, <span class="dt">override =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Subsequently, we define the projection, the extent and the resolution.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="gis.html#cb332-1"></a><span class="kw">execGRASS</span>(<span class="st">&quot;g.proj&quot;</span>, <span class="dt">flags =</span> <span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;quiet&quot;</span>), </span>
<span id="cb332-2"><a href="gis.html#cb332-2"></a>          <span class="dt">proj4 =</span> <span class="kw">st_crs</span>(london_streets)<span class="op">$</span>proj4string)</span>
<span id="cb332-3"><a href="gis.html#cb332-3"></a>b_box =<span class="st"> </span><span class="kw">st_bbox</span>(london_streets) </span>
<span id="cb332-4"><a href="gis.html#cb332-4"></a><span class="kw">execGRASS</span>(<span class="st">&quot;g.region&quot;</span>, <span class="dt">flags =</span> <span class="kw">c</span>(<span class="st">&quot;quiet&quot;</span>), </span>
<span id="cb332-5"><a href="gis.html#cb332-5"></a>          <span class="dt">n =</span> <span class="kw">as.character</span>(b_box[<span class="st">&quot;ymax&quot;</span>]), <span class="dt">s =</span> <span class="kw">as.character</span>(b_box[<span class="st">&quot;ymin&quot;</span>]), </span>
<span id="cb332-6"><a href="gis.html#cb332-6"></a>          <span class="dt">e =</span> <span class="kw">as.character</span>(b_box[<span class="st">&quot;xmax&quot;</span>]), <span class="dt">w =</span> <span class="kw">as.character</span>(b_box[<span class="st">&quot;xmin&quot;</span>]), </span>
<span id="cb332-7"><a href="gis.html#cb332-7"></a>          <span class="dt">res =</span> <span class="st">&quot;1&quot;</span>)</span></code></pre></div>
<p>Once you are familiar with how to set up the GRASS environment, it becomes tedious to do so over and over again.
Luckily, <code>linkGRASS7()</code> of the <strong>link2GI</strong> packages lets you do it with one line of code.
The only thing you need to provide is a spatial object which determines the projection and the extent of the spatial database..
First, <code>linkGRASS7()</code> finds all GRASS installations on your computer.
Since we have set <code>ver_select</code> to <code>TRUE</code>, we can interactively choose one of the found GRASS-installations.
If there is just one installation, the <code>linkGRASS7()</code> automatically chooses this one.
Second, <code>linkGRASS7()</code> establishes a connection to GRASS 7.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="gis.html#cb333-1"></a>link2GI<span class="op">::</span><span class="kw">linkGRASS7</span>(london_streets, <span class="dt">ver_select =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Before we can use GRASS geoalgorithms, we need to add data to GRASS’s spatial database.
Luckily, the convenience function <code>writeVECT()</code> does this for us.
(Use <code>writeRAST()</code> in the case of raster data.)
In our case we add the street and cycle hire point data while using only the first attribute column, and name them also <code>london_streets</code> and <code>points</code>.</p>
<p>To use <strong>sf</strong>-objects with <strong>rgrass7</strong>, we have to run <code>use_sf()</code> first (note: the code below assumes you are running <strong>rgrass7</strong> 0.2.1 or above).</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="gis.html#cb334-1"></a><span class="kw">use_sf</span>()</span>
<span id="cb334-2"><a href="gis.html#cb334-2"></a><span class="kw">writeVECT</span>(<span class="dt">SDF =</span> london_streets, <span class="dt">vname =</span> <span class="st">&quot;london_streets&quot;</span>)</span>
<span id="cb334-3"><a href="gis.html#cb334-3"></a><span class="kw">writeVECT</span>(<span class="dt">SDF =</span> points[, <span class="dv">1</span>], <span class="dt">vname =</span> <span class="st">&quot;points&quot;</span>)</span></code></pre></div>
<p>To perform our network analysis, we need a topological clean street network.
GRASS’s <code>v.clean</code> takes care of the removal of duplicates, small angles and dangles, among others.
Here, we break lines at each intersection to ensure that the subsequent routing algorithm can actually turn right or left at an intersection, and save the output in a GRASS object named <code>streets_clean</code>.
It is likely that a few of our cycling station points will not lie exactly on a street segment.
However, to find the shortest route between them, we need to connect them to the nearest streets segment.
<code>v.net</code>’s connect-operator does exactly this.
We save its output in <code>streets_points_con</code>.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="gis.html#cb335-1"></a><span class="co"># clean street network</span></span>
<span id="cb335-2"><a href="gis.html#cb335-2"></a><span class="kw">execGRASS</span>(<span class="dt">cmd =</span> <span class="st">&quot;v.clean&quot;</span>, <span class="dt">input =</span> <span class="st">&quot;london_streets&quot;</span>, <span class="dt">output =</span> <span class="st">&quot;streets_clean&quot;</span>,</span>
<span id="cb335-3"><a href="gis.html#cb335-3"></a>          <span class="dt">tool =</span> <span class="st">&quot;break&quot;</span>, <span class="dt">flags =</span> <span class="st">&quot;overwrite&quot;</span>)</span>
<span id="cb335-4"><a href="gis.html#cb335-4"></a><span class="co"># connect points with street network</span></span>
<span id="cb335-5"><a href="gis.html#cb335-5"></a><span class="kw">execGRASS</span>(<span class="dt">cmd =</span> <span class="st">&quot;v.net&quot;</span>, <span class="dt">input =</span> <span class="st">&quot;streets_clean&quot;</span>, <span class="dt">output =</span> <span class="st">&quot;streets_points_con&quot;</span>, </span>
<span id="cb335-6"><a href="gis.html#cb335-6"></a>          <span class="dt">points =</span> <span class="st">&quot;points&quot;</span>, <span class="dt">operation =</span> <span class="st">&quot;connect&quot;</span>, <span class="dt">threshold =</span> <span class="fl">0.001</span>,</span>
<span id="cb335-7"><a href="gis.html#cb335-7"></a>          <span class="dt">flags =</span> <span class="kw">c</span>(<span class="st">&quot;overwrite&quot;</span>, <span class="st">&quot;c&quot;</span>))</span></code></pre></div>
<p>The resulting clean dataset serves as input for the <code>v.net.salesman</code>-algorithm, which finally finds the shortest route between all cycle hire stations.
<code>center_cats</code> requires a numeric range as input.
This range represents the points for which a shortest route should be calculated.
Since we would like to calculate the route for all cycle stations, we set it to <code>1-25</code>.
To access the GRASS help page of the traveling salesman algorithm, run <code>execGRASS("g.manual", entry = "v.net.salesman")</code>.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="gis.html#cb336-1"></a><span class="kw">execGRASS</span>(<span class="dt">cmd =</span> <span class="st">&quot;v.net.salesman&quot;</span>, <span class="dt">input =</span> <span class="st">&quot;streets_points_con&quot;</span>,</span>
<span id="cb336-2"><a href="gis.html#cb336-2"></a>          <span class="dt">output =</span> <span class="st">&quot;shortest_route&quot;</span>, <span class="dt">center_cats =</span> <span class="kw">paste0</span>(<span class="st">&quot;1-&quot;</span>, <span class="kw">nrow</span>(points)),</span>
<span id="cb336-3"><a href="gis.html#cb336-3"></a>          <span class="dt">flags =</span> <span class="kw">c</span>(<span class="st">&quot;overwrite&quot;</span>))</span></code></pre></div>
<p>To visualize our result, we import the output layer into R, convert it into an sf-object keeping only the geometry, and visualize it with the help of the <strong>mapview</strong> package (Figure <a href="gis.html#fig:grass-mapview">9.3</a> and Section <a href="adv-map.html#interactive-maps">8.4</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:grass-mapview"></span>
<img src="figures/09_shortest_route.png" alt="Shortest route (blue line) between 24 cycle hire stations (blue dots) on the OSM street network of London." width="80%" />
<p class="caption">
FIGURE 9.3: Shortest route (blue line) between 24 cycle hire stations (blue dots) on the OSM street network of London.
</p>
</div>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="gis.html#cb337-1"></a>route =<span class="st"> </span><span class="kw">readVECT</span>(<span class="st">&quot;shortest_route&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb337-2"><a href="gis.html#cb337-2"></a><span class="st">  </span><span class="kw">st_as_sf</span>() <span class="op">%&gt;%</span></span>
<span id="cb337-3"><a href="gis.html#cb337-3"></a><span class="st">  </span><span class="kw">st_geometry</span>()</span>
<span id="cb337-4"><a href="gis.html#cb337-4"></a>mapview<span class="op">::</span><span class="kw">mapview</span>(route, <span class="dt">map.types =</span> <span class="st">&quot;OpenStreetMap.BlackAndWhite&quot;</span>, <span class="dt">lwd =</span> <span class="dv">7</span>) <span class="op">+</span></span>
<span id="cb337-5"><a href="gis.html#cb337-5"></a><span class="st">  </span>points</span></code></pre></div>
<p>There are a few important considerations to note in the process:</p>
<ul>
<li>We could have used GRASS’s spatial database (based on SQLite) which allows faster processing.
That means we have only exported geographic data at the beginning.
Then we created new objects but only imported the final result back into R.
To find out which datasets are currently available, run <code>execGRASS("g.list", type = "vector,raster", flags = "p")</code>.</li>
<li>We could have also accessed an already existing GRASS spatial database from within R.
Prior to importing data into R, you might want to perform some (spatial) subsetting.
Use <code>v.select</code> and <code>v.extract</code> for vector data.
<code>db.select</code> lets you select subsets of the attribute table of a vector layer without returning the corresponding geometry.</li>
<li>You can also start R from within a running GRASS session <span class="citation">(for more information please refer to Bivand, Pebesma, and Gómez-Rubio <a href="#ref-bivand_applied_2013" role="doc-biblioref">2013</a> and this <a href="https://grasswiki.osgeo.org/wiki/R_statistics/rgrass7" role="doc-biblioref">wiki</a>)</span>.</li>
<li>Refer to the excellent <a href="https://grass.osgeo.org/grass77/manuals/">GRASS online help</a> or <code>execGRASS("g.manual", flags = "i")</code> for more information on each available GRASS geoalgorithm.</li>
<li>If you would like to use GRASS 6 from within R, use the R package <strong>spgrass6</strong>.</li>
</ul>
</div>
<div id="when-to-use-what" class="section level2">
<h2><span class="header-section-number">9.5</span> When to use what?</h2>
<p>To recommend a single R-GIS interface is hard since the usage depends on personal preferences, the tasks at hand and your familiarity with different GIS software packages which in turn probably depends on your field of study.
As mentioned previously, SAGA is especially good at the fast processing of large (high-resolution) raster datasets, and frequently used by hydrologists, climatologists and soil scientists <span class="citation">(Conrad et al. <a href="#ref-conrad_system_2015" role="doc-biblioref">2015</a>)</span>.
GRASS GIS, on the other hand, is the only GIS presented here supporting a topologically based spatial database which is especially useful for network analyses but also simulation studies (see below).
QGIS is much more user-friendly compared to GRASS- and SAGA-GIS, especially for first-time GIS users, and probably the most popular open-source GIS.
Therefore, <strong>RQGIS</strong> is an appropriate choice for most use cases.
Its main advantages are</p>
<ul>
<li>a unified access to several GIS, and therefore the provision of &gt;1000 geoalgorithms (Table <a href="gis.html#tab:gis-comp">9.1</a>) including duplicated functionality, e.g., you can perform overlay-operations using QGIS-, SAGA- or GRASS-geoalgorithms;</li>
<li>automatic data format conversions (SAGA uses <code>.sdat</code> grid files and GRASS uses its own database format but QGIS will handle the corresponding conversions);</li>
<li>its automatic passing of geographic R objects to QGIS geoalgorithms and back into R; and</li>
<li>convenience functions to support the access of the online help, named arguments and automatic default value retrieval (<strong>rgrass7</strong> inspired the latter two features).</li>
</ul>
<p>By all means, there are use cases when you certainly should use one of the other R-GIS bridges.
Though QGIS is the only GIS providing a unified interface to several GIS software packages, it only provides access to a subset of the corresponding third-party geoalgorithms (for more information please refer to <span class="citation">Muenchow, Schratz, and Brenning (<a href="#ref-muenchow_rqgis:_2017" role="doc-biblioref">2017</a>)</span>).
Therefore, to use the complete set of SAGA and GRASS functions, stick with <strong>RSAGA</strong> and <strong>rgrass7</strong>.
When doing so, take advantage of <strong>RSAGA</strong>’s numerous user-friendly functions.
Note also, that <strong>RSAGA</strong> offers native R functions for geocomputation such as <code>multi.local.function()</code>, <code>pick.from.points()</code> and many more.
<strong>RSAGA</strong> supports much more SAGA versions than (R)QGIS.
Finally, if you need topological correct data and/or spatial database management functionality such as multi-user access, we recommend the usage of GRASS.
In addition, if you would like to run simulations with the help of a geodatabase <span class="citation">(Krug, Roura-Pascual, and Richardson <a href="#ref-krug_clearing_2010" role="doc-biblioref">2010</a>)</span>, use <strong>rgrass7</strong> directly since <strong>RQGIS</strong> always starts a new GRASS session for each call.</p>
<p>Please note that there are a number of further GIS software packages that have a scripting interface but for which there is no dedicated R package that accesses these: gvSig, OpenJump, Orfeo Toolbox and TauDEM.</p>
</div>
<div id="other-bridges" class="section level2">
<h2><span class="header-section-number">9.6</span> Other bridges</h2>
<p>The focus of this chapter is on R interfaces to Desktop GIS software.
We emphasize these bridges because dedicated GIS software is well-known and a common ‘way in’ to understanding geographic data.
They also provide access to many geoalgorithms.</p>
<p>Other ‘bridges’ include interfaces to spatial libraries (Section <a href="gis.html#gdal">9.6.1</a> shows how to access the GDAL CLI from R), spatial databases (see Section <a href="gis.html#postgis">9.6.2</a>) and web mapping services (see Chapter <a href="adv-map.html#adv-map">8</a>).
This section provides only a snippet of what is possible.
Thanks to R’s flexibility, with its ability to call other programs from the system and integration with other languages (notably via <strong>Rcpp</strong> and <strong>reticulate</strong>), many other bridges are possible.
The aim is not to be comprehensive, but to demonstrate other ways of accessing the ‘flexibility and power’ in the quote by <span class="citation">Sherman (<a href="#ref-sherman_desktop_2008" role="doc-biblioref">2008</a>)</span> at the beginning of the chapter.</p>
<div id="gdal" class="section level3">
<h3><span class="header-section-number">9.6.1</span> Bridges to GDAL</h3>
<p>As discussed in Chapter <a href="read-write.html#read-write">7</a>, GDAL is a low-level library that supports many geographic data formats.
GDAL is so effective that most GIS programs use GDAL in the background for importing and exporting geographic data, rather than re-inventing the wheel and using bespoke read-write code.
But GDAL offers more than data I/O.
It has <a href="http://www.gdal.org/pages.html">geoprocessing tools</a> for vector and raster data, functionality to create <a href="https://www.gdal.org/gdal2tiles.html">tiles</a> for serving raster data online, and rapid <a href="https://www.gdal.org/gdal_rasterize.html">rasterization</a> of vector data, all of which can be accessed via the system of R command line.</p>
<p>The code chunk below demonstrates this functionality:
<code>linkGDAL()</code> searches the computer for a working GDAL installation and adds the location of the executable files to the PATH variable, allowing GDAL to be called.
In the example below <code>ogrinfo</code> provides metadata on a vector dataset:</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="gis.html#cb338-1"></a>link2GI<span class="op">::</span><span class="kw">linkGDAL</span>()</span>
<span id="cb338-2"><a href="gis.html#cb338-2"></a>cmd =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;ogrinfo -ro -so -al&quot;</span>, <span class="kw">system.file</span>(<span class="st">&quot;shape/nc.shp&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;sf&quot;</span>))</span>
<span id="cb338-3"><a href="gis.html#cb338-3"></a><span class="kw">system</span>(cmd)</span>
<span id="cb338-4"><a href="gis.html#cb338-4"></a><span class="co">#&gt; INFO: Open of `C:/Users/geocompr/Documents/R/win-library/3.5/sf/shape/nc.shp&#39;</span></span>
<span id="cb338-5"><a href="gis.html#cb338-5"></a><span class="co">#&gt;     using driver `ESRI Shapefile&#39; successful.</span></span>
<span id="cb338-6"><a href="gis.html#cb338-6"></a><span class="co">#&gt; </span></span>
<span id="cb338-7"><a href="gis.html#cb338-7"></a><span class="co">#&gt; Layer name: nc</span></span>
<span id="cb338-8"><a href="gis.html#cb338-8"></a><span class="co">#&gt; Metadata:</span></span>
<span id="cb338-9"><a href="gis.html#cb338-9"></a><span class="co">#&gt;  DBF_DATE_LAST_UPDATE=2016-10-26</span></span>
<span id="cb338-10"><a href="gis.html#cb338-10"></a><span class="co">#&gt; Geometry: Polygon</span></span>
<span id="cb338-11"><a href="gis.html#cb338-11"></a><span class="co">#&gt; Feature Count: 100</span></span>
<span id="cb338-12"><a href="gis.html#cb338-12"></a><span class="co">#&gt; Extent: (-84.323853, 33.881992) - (-75.456978, 36.589649)</span></span>
<span id="cb338-13"><a href="gis.html#cb338-13"></a><span class="co">#&gt; Layer SRS WKT:</span></span>
<span id="cb338-14"><a href="gis.html#cb338-14"></a><span class="co">#&gt; ...</span></span></code></pre></div>
<p>This example — which returns the same result as <code>rgdal::ogrInfo()</code> — may be simple, but it shows how to use GDAL via the system command-line, independently of other packages.
The ‘link’ to GDAL provided by <strong>link2gi</strong> could be used as a foundation for doing more advanced GDAL work from the R or system CLI.<a href="#fn46" class="footnote-ref" id="fnref46"><sup>46</sup></a>
TauDEM (<a href="http://hydrology.usu.edu/taudem/taudem5/index.html" class="uri">http://hydrology.usu.edu/taudem/taudem5/index.html</a>) and the Orfeo Toolbox (<a href="https://www.orfeo-toolbox.org/" class="uri">https://www.orfeo-toolbox.org/</a>) are other spatial data processing libraries/programs offering a command line interface.
At the time of writing, it appears that there is only a developer version of an R/TauDEM interface on R-Forge (<a href="https://r-forge.r-project.org/R/?group_id=956" class="uri">https://r-forge.r-project.org/R/?group_id=956</a>).
In any case, the above example shows how to access these libraries from the system command line via R.
This in turn could be the starting point for creating a proper interface to these libraries in the form of new R packages.</p>
<p>Before diving into a project to create a new bridge, however, it is important to be aware of the power of existing R packages and that <code>system()</code> calls may not be platform-independent (they may fail on some computers).
Furthermore, <strong>sf</strong> brings most of the power provided by GDAL, GEOS and PROJ to R via the R/C++ interface provided by <strong>Rcpp</strong>, which avoids <code>system()</code> calls.</p>
</div>
<div id="postgis" class="section level3">
<h3><span class="header-section-number">9.6.2</span> Bridges to spatial databases</h3>
<p>
Spatial database management systems (spatial DBMS) store spatial and non-spatial data in a structured way.
They can organize large collections of data into related tables (entities) via unique identifiers (primary and foreign keys) and implicitly via space (think for instance of a spatial join).
This is useful because geographic datasets tend to become big and messy quite quickly.
Databases enable storing and querying large datasets efficiently based on spatial and non-spatial fields, and provide multi-user access and topology support.</p>
<p>The most important open source spatial database is PostGIS <span class="citation">(Obe and Hsu <a href="#ref-obe_postgis_2015" role="doc-biblioref">2015</a>)</span>.<a href="#fn47" class="footnote-ref" id="fnref47"><sup>47</sup></a>
R bridges to spatial DBMSs such as PostGIS are important, allowing access to huge data stores without loading several gigabytes of geographic data into RAM, and likely crashing the R session.
The remainder of this section shows how PostGIS can be called from R, based on “Hello real word” from <em>PostGIS in Action, Second Edition</em> <span class="citation">(Obe and Hsu <a href="#ref-obe_postgis_2015" role="doc-biblioref">2015</a>)</span>.<a href="#fn48" class="footnote-ref" id="fnref48"><sup>48</sup></a></p>
<p>The subsequent code requires a working internet connection, since we are accessing a PostgreSQL/PostGIS database which is living in the QGIS Cloud (<a href="https://qgiscloud.com/" class="uri">https://qgiscloud.com/</a>).<a href="#fn49" class="footnote-ref" id="fnref49"><sup>49</sup></a></p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="gis.html#cb339-1"></a><span class="kw">library</span>(RPostgreSQL)</span>
<span id="cb339-2"><a href="gis.html#cb339-2"></a>conn =<span class="st"> </span><span class="kw">dbConnect</span>(<span class="dt">drv =</span> <span class="kw">PostgreSQL</span>(), <span class="dt">dbname =</span> <span class="st">&quot;rtafdf_zljbqm&quot;</span>,</span>
<span id="cb339-3"><a href="gis.html#cb339-3"></a>                 <span class="dt">host =</span> <span class="st">&quot;db.qgiscloud.com&quot;</span>,</span>
<span id="cb339-4"><a href="gis.html#cb339-4"></a>                 <span class="dt">port =</span> <span class="st">&quot;5432&quot;</span>, <span class="dt">user =</span> <span class="st">&quot;rtafdf_zljbqm&quot;</span>, </span>
<span id="cb339-5"><a href="gis.html#cb339-5"></a>                 <span class="dt">password =</span> <span class="st">&quot;d3290ead&quot;</span>)</span></code></pre></div>
<p>Often the first question is, ‘which tables can be found in the database?’.
This can be asked as follows (the answer is 5 tables):</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="gis.html#cb340-1"></a><span class="kw">dbListTables</span>(conn)</span>
<span id="cb340-2"><a href="gis.html#cb340-2"></a><span class="co">#&gt; [1] &quot;spatial_ref_sys&quot; &quot;topology&quot;        &quot;layer&quot;           &quot;restaurants&quot;    </span></span>
<span id="cb340-3"><a href="gis.html#cb340-3"></a><span class="co">#&gt; [5] &quot;highways&quot; </span></span></code></pre></div>
<p>We are only interested in the <code>restaurants</code> and the <code>highways</code> tables.
The former represents the locations of fast-food restaurants in the US, and the latter are principal US highways.
To find out about attributes available in a table, we can run:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="gis.html#cb341-1"></a><span class="kw">dbListFields</span>(conn, <span class="st">&quot;highways&quot;</span>)</span>
<span id="cb341-2"><a href="gis.html#cb341-2"></a><span class="co">#&gt; [1] &quot;qc_id&quot;        &quot;wkb_geometry&quot; &quot;gid&quot;          &quot;feature&quot;     </span></span>
<span id="cb341-3"><a href="gis.html#cb341-3"></a><span class="co">#&gt; [5] &quot;name&quot;         &quot;state&quot;   </span></span></code></pre></div>
<p>The first query will select <code>US Route 1</code> in Maryland (<code>MD</code>).
Note that <code>st_read()</code> allows us to read geographic data from a database if it is provided with an open connection to a database and a query.
Additionally, <code>st_read()</code> needs to know which column represents the geometry (here: <code>wkb_geometry</code>).</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="gis.html#cb342-1"></a>query =<span class="st"> </span><span class="kw">paste</span>(</span>
<span id="cb342-2"><a href="gis.html#cb342-2"></a>  <span class="st">&quot;SELECT *&quot;</span>,</span>
<span id="cb342-3"><a href="gis.html#cb342-3"></a>  <span class="st">&quot;FROM highways&quot;</span>,</span>
<span id="cb342-4"><a href="gis.html#cb342-4"></a>  <span class="st">&quot;WHERE name = &#39;US Route 1&#39; AND state = &#39;MD&#39;;&quot;</span>)</span>
<span id="cb342-5"><a href="gis.html#cb342-5"></a>us_route =<span class="st"> </span><span class="kw">st_read</span>(conn, <span class="dt">query =</span> query, <span class="dt">geom =</span> <span class="st">&quot;wkb_geometry&quot;</span>)</span></code></pre></div>
<p>This results in an <strong>sf</strong>-object named <code>us_route</code> of type <code>sfc_MULTILINESTRING</code>.
The next step is to add a 20-mile buffer (corresponds to 1609 meters times 20) around the selected highway (Figure <a href="gis.html#fig:postgis">9.4</a>).</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="gis.html#cb343-1"></a>query =<span class="st"> </span><span class="kw">paste</span>(</span>
<span id="cb343-2"><a href="gis.html#cb343-2"></a>  <span class="st">&quot;SELECT ST_Union(ST_Buffer(wkb_geometry, 1609 * 20))::geometry&quot;</span>,</span>
<span id="cb343-3"><a href="gis.html#cb343-3"></a>  <span class="st">&quot;FROM highways&quot;</span>,</span>
<span id="cb343-4"><a href="gis.html#cb343-4"></a>  <span class="st">&quot;WHERE name = &#39;US Route 1&#39; AND state = &#39;MD&#39;;&quot;</span>)</span>
<span id="cb343-5"><a href="gis.html#cb343-5"></a>buf =<span class="st"> </span><span class="kw">st_read</span>(conn, <span class="dt">query =</span> query)</span></code></pre></div>
<p>Note that this was a spatial query using functions (<code>ST_Union()</code>, <code>ST_Buffer()</code>) you should be already familiar with since you find them also in the <strong>sf</strong>-package, though here they are written in lowercase characters (<code>st_union()</code>, <code>st_buffer()</code>).
In fact, function names of the <strong>sf</strong> package largely follow the PostGIS naming conventions.<a href="#fn50" class="footnote-ref" id="fnref50"><sup>50</sup></a>
The last query will find all Hardee restaurants (<code>HDE</code>) within the buffer zone (Figure <a href="gis.html#fig:postgis">9.4</a>).</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="gis.html#cb344-1"></a>query =<span class="st"> </span><span class="kw">paste</span>(</span>
<span id="cb344-2"><a href="gis.html#cb344-2"></a>  <span class="st">&quot;SELECT r.wkb_geometry&quot;</span>,</span>
<span id="cb344-3"><a href="gis.html#cb344-3"></a>  <span class="st">&quot;FROM restaurants r&quot;</span>,</span>
<span id="cb344-4"><a href="gis.html#cb344-4"></a>  <span class="st">&quot;WHERE EXISTS (&quot;</span>,</span>
<span id="cb344-5"><a href="gis.html#cb344-5"></a>  <span class="st">&quot;SELECT gid&quot;</span>,</span>
<span id="cb344-6"><a href="gis.html#cb344-6"></a>  <span class="st">&quot;FROM highways&quot;</span>,</span>
<span id="cb344-7"><a href="gis.html#cb344-7"></a>  <span class="st">&quot;WHERE&quot;</span>,</span>
<span id="cb344-8"><a href="gis.html#cb344-8"></a>  <span class="st">&quot;ST_DWithin(r.wkb_geometry, wkb_geometry, 1609 * 20) AND&quot;</span>,</span>
<span id="cb344-9"><a href="gis.html#cb344-9"></a>  <span class="st">&quot;name = &#39;US Route 1&#39; AND&quot;</span>,</span>
<span id="cb344-10"><a href="gis.html#cb344-10"></a>  <span class="st">&quot;state = &#39;MD&#39; AND&quot;</span>,</span>
<span id="cb344-11"><a href="gis.html#cb344-11"></a>  <span class="st">&quot;r.franchise = &#39;HDE&#39;);&quot;</span></span>
<span id="cb344-12"><a href="gis.html#cb344-12"></a>)</span>
<span id="cb344-13"><a href="gis.html#cb344-13"></a>hardees =<span class="st"> </span><span class="kw">st_read</span>(conn, <span class="dt">query =</span> query)</span></code></pre></div>
<p>Please refer to <span class="citation">Obe and Hsu (<a href="#ref-obe_postgis_2015" role="doc-biblioref">2015</a>)</span> for a detailed explanation of the spatial SQL query.
Finally, it is good practice to close the database connection as follows:<a href="#fn51" class="footnote-ref" id="fnref51"><sup>51</sup></a></p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="gis.html#cb345-1"></a>RPostgreSQL<span class="op">::</span><span class="kw">postgresqlCloseConnection</span>(conn)</span></code></pre></div>
<pre><code>#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()
#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:postgis"></span>
<img src="09-gis_files/figure-html/postgis-1.png" alt="Visualization of the output of previous PostGIS commands showing the highway (black line), a buffer (light yellow) and three restaurants (light blue points) within the buffer." width="60%" />
<p class="caption">
FIGURE 9.4: Visualization of the output of previous PostGIS commands showing the highway (black line), a buffer (light yellow) and three restaurants (light blue points) within the buffer.
</p>
</div>
<p>Unlike PostGIS, <strong>sf</strong> only supports spatial vector data.
To query and manipulate raster data stored in a PostGIS database, use the <strong>rpostgis</strong> package <span class="citation">(Bucklin and Basille <a href="#ref-bucklin_rpostgis_2018" role="doc-biblioref">2018</a>)</span> and/or use command-line tools such as <code>rastertopgsql</code> which comes as part of the PostGIS installation.</p>
<p>This subsection is only a brief introduction to PostgreSQL/PostGIS.
Nevertheless, we would like to encourage the practice of storing geographic and non-geographic data in a spatial DBMS while only attaching those subsets to R’s global environment which are needed for further (geo-)statistical analysis.
Please refer to <span class="citation">Obe and Hsu (<a href="#ref-obe_postgis_2015" role="doc-biblioref">2015</a>)</span> for a more detailed description of the SQL queries presented and a more comprehensive introduction to PostgreSQL/PostGIS in general.
PostgreSQL/PostGIS is a formidable choice as an open-source spatial database.
But the same is true for the lightweight SQLite/SpatiaLite database engine and GRASS which uses SQLite in the background (see Section <a href="gis.html#rgrass">9.4</a>).</p>
<p>As a final note, if your data is getting too big for PostgreSQL/PostGIS and you require massive spatial data management and query performance, then the next logical step is to use large-scale geographic querying on distributed computing systems, as for example, provided by GeoMesa (<a href="http://www.geomesa.org/" class="uri">http://www.geomesa.org/</a>) or GeoSpark <span class="citation">(<a href="http://geospark.datasyslab.org/" class="uri" role="doc-biblioref">http://geospark.datasyslab.org/</a>; Huang et al. <a href="#ref-huang_geospark_2017" role="doc-biblioref">2017</a>)</span>.</p>
</div>
</div>
<div id="exercises-7" class="section level2">
<h2><span class="header-section-number">9.7</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Create two overlapping polygons (<code>poly_1</code> and <code>poly_2</code>) with the help of the <strong>sf</strong>-package (see Chapter <a href="spatial-class.html#spatial-class">2</a>).</p></li>
<li><p>Union <code>poly_1</code> and <code>poly_2</code> using <code>st_union()</code> and <code>qgis:union</code>.
What is the difference between the two union operations?
How can we use the <strong>sf</strong> package to obtain the same result as QGIS?</p></li>
<li><p>Calculate the intersection of <code>poly_1</code> and <code>poly_2</code> using:</p>
<ul>
<li><strong>RQGIS</strong>, <strong>RSAGA</strong> and <strong>rgrass7</strong></li>
<li><strong>sf</strong></li>
</ul></li>
<li><p>Attach <code>data(dem, package = "spDataLarge")</code> and <code>data(random_points, package = "spDataLarge")</code>.
Select randomly a point from <code>random_points</code> and find all <code>dem</code> pixels that can be seen from this point (hint: viewshed).
Visualize your result.
For example, plot a hillshade, and on top of it the digital elevation model, your viewshed output and the point.
Additionally, give <code>mapview</code> a try.</p></li>
<li><p>Compute catchment area and catchment slope of <code>data("dem", package = "spDataLarge")</code> using <strong>RSAGA</strong> (see Section <a href="gis.html#rsaga">9.3</a>).</p></li>
<li><p>Use <code>gdalinfo</code> via a system call for a raster file stored on disk of your choice (see Section <a href="gis.html#gdal">9.6.1</a>).</p></li>
<li><p>Query all Californian highways from the PostgreSQL/PostGIS database living in the QGIS Cloud introduced in this chapter (see Section <a href="gis.html#postgis">9.6.2</a>).</p></li>
</ol>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-bivand_applied_2013">
<p>Bivand, Roger, Edzer J Pebesma, and Virgilio Gómez-Rubio. 2013. <em>Applied Spatial Data Analysis with R</em>. Vol. 747248717. Springer.</p>
</div>
<div id="ref-bucklin_rpostgis_2018">
<p>Bucklin, David, and Mathieu Basille. 2018. “Rpostgis: Linking R with a PostGIS Spatial Database.” <em>The R Journal</em>.</p>
</div>
<div id="ref-chambers_extending_2016">
<p>Chambers, John M. 2016. <em>Extending R</em>. CRC Press.</p>
</div>
<div id="ref-conrad_system_2015">
<p>Conrad, O., B. Bechtel, M. Bock, H. Dietrich, E. Fischer, L. Gerlitz, J. Wehberg, V. Wichmann, and J. Böhner. 2015. “System for Automated Geoscientific Analyses (SAGA) V. 2.1.4.” <em>Geosci. Model Dev.</em> 8 (7): 1991–2007. <a href="https://doi.org/10.5194/gmd-8-1991-2015">https://doi.org/10.5194/gmd-8-1991-2015</a>.</p>
</div>
<div id="ref-graser_processing_2015">
<p>Graser, Anita, and Victor Olaya. 2015. “Processing: A Python Framework for the Seamless Integration of Geoprocessing Tools in QGIS.”</p>
</div>
<div id="ref-huang_geospark_2017">
<p>Huang, Zhou, Yiran Chen, Lin Wan, and Xia Peng. 2017. “GeoSpark SQL: An Effective Framework Enabling Spatial Queries on Spark.” <em>ISPRS International Journal of Geo-Information</em> 6 (9): 285. <a href="https://doi.org/10.3390/ijgi6090285">https://doi.org/10.3390/ijgi6090285</a>.</p>
</div>
<div id="ref-krug_clearing_2010">
<p>Krug, Rainer M., Núria Roura-Pascual, and David M. Richardson. 2010. “Clearing of Invasive Alien Plants Under Different Budget Scenarios: Using a Simulation Model to Test Efficiency.” <em>Biological Invasions</em> 12 (12): 4099–4112.</p>
</div>
<div id="ref-landa_new_2008">
<p>Landa, Martin. 2008. “New GUI for GRASS GIS Based on wxPython.” <em>Departament of Geodesy and Cartography</em>, 1–17.</p>
</div>
<div id="ref-longley_geographic_2015">
<p>Longley, Paul. 2015. <em>Geographic Information Science &amp; Systems</em>. Fourth edition. Hoboken, NJ: Wiley.</p>
</div>
<div id="ref-muenchow_geomorphic_2012">
<p>Muenchow, Jannes, Alexander Brenning, and Michael Richter. 2012. “Geomorphic Process Rates of Landslides Along a Humidity Gradient in the Tropical Andes.” <em>Geomorphology</em> 139-140 (February): 271–84. <a href="https://doi.org/10.1016/j.geomorph.2011.10.029">https://doi.org/10.1016/j.geomorph.2011.10.029</a>.</p>
</div>
<div id="ref-muenchow_rqgis:_2017">
<p>Muenchow, Jannes, Patrick Schratz, and Alexander Brenning. 2017. “RQGIS: Integrating R with QGIS for Statistical Geocomputing.” <em>The R Journal</em> 9 (2): 409–28.</p>
</div>
<div id="ref-neteler_open_2008">
<p>Neteler, Markus, and Helena Mitasova. 2008. <em>Open Source GIS: A GRASS GIS Approach</em>. Third. New York, NY: Springer.</p>
</div>
<div id="ref-obe_postgis_2015">
<p>Obe, Regina O., and Leo S. Hsu. 2015. <em>PostGIS in Action</em>. Second. Shelter Island, NY: Manning.</p>
</div>
<div id="ref-sherman_desktop_2008">
<p>Sherman, Gary. 2008. <em>Desktop GIS: Mapping the Planet with Open Source Tools</em>. Pragmatic Bookshelf.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="40">
<li id="fn40"><p>
Packages that have already been used including <strong>spData</strong>, <strong>spDataLarge</strong> and <strong>dplyr</strong> also need to be installed. <a href="gis.html#fnref40" class="footnote-back">↩︎</a></p></li>
<li id="fn41"><p>
Other ‘command-lines’ include terminals for interacting with the operating system and other interpreted languages such as Python.
<!-- System commands can be sent from R with the `system()` and those of -->
Many GISs originated as a CLI:
it was only after the widespread uptake of computer mice and high-resolution screens in the 1990s that GUIs became common.
GRASS, one of the longest-standing GIS programs, for example, relied primarily on command-line interaction before it gained a sophisticated GUI <span class="citation">(Landa <a href="#ref-landa_new_2008" role="doc-biblioref">2008</a>)</span>.<a href="gis.html#fnref41" class="footnote-back">↩︎</a></p></li>
<li id="fn42"><p>GRASS GIS and PostGIS are popular in academia and industry and can be seen as products which buck this trend as they are built around the command-line.
<!-- Should the commented-out mega-footnote go in a vignette? (todo, RL) -->
<!-- yes, we should shorten the footnote or put it somewhere into the text. I just rewrote it to make clearer what was meant. At least this was what I gathered. -->
<!-- In [2008](http://gama.fsv.cvut.cz/~landa/publications/2008/gis-ostrava-08/paper/landa-grass-gui-wxpython.pdf) GRASS developers added a sophisticated GUI, shifting the emphasis slightly away from its CLI. -->
<!-- However, GRASS lacks a sophisticated and feature-rich IDE such as RStudio that supports 'CLI newbies'.  -->
<!-- On the other hand, PostGIS is the spatial extension of the popular PostgreSQL open source database, and therefore not really a dedicated GIS.  -->
<!-- This is also highlighted by the fact that PostGIS lacks any geovisualization capabilities and its description of 'legacy GIS' on its [website](http://workshops.boundlessgeo.com/postgis-intro/introduction.html). -->
<!-- Similar to GRASS, PostgreSQGL provides a (partial) GUI called [pgAdmin](https://www.pgadmin.org/) to facilitate the editing and administration of the database.  -->
<!-- To make it clear, though PostGIS provides spatial functions, its main purpose is the handling of spatial objects in a relational database management system. -->
<!-- Therefore, frequently users store their spatial data in PostGIS, and interact with it through a dedicated GIS software such as QGIS. Of course, you can also use R to access data from PostGIS (**sf**, **rgdal**, **rpostgis**). -->
<!-- In summary,  a typical workflow would be: perform a large spatial query with PostGIS, then load the result into a further application (QGIS, R) for further geoprocessing.--><a href="gis.html#fnref42" class="footnote-back">↩︎</a></p></li>
<li id="fn43"><p>
The <strong>mapedit</strong> package allows the quick editing of a few spatial features but not professional, large-scale cartographic digitizing;<a href="gis.html#fnref43" class="footnote-back">↩︎</a></p></li>
<li id="fn44"><p>
An early use of the term ‘bridge’ referred to the coupling of R with GRASS <span class="citation">(Neteler and Mitasova <a href="#ref-neteler_open_2008" role="doc-biblioref">2008</a>)</span>.
Roger Bivand elaborated on this in his talk, “Bridges between GIS and R”, delivered at the 2016 GEOSTAT summer school (see slides at: <a href="http://spatial.nhh.no/misc/" class="uri">http://spatial.nhh.no/misc/</a>).
<!-- The resulting slides can be found on Roger's personal website at [http://spatial.nhh.no/misc](http://spatial.nhh.no/misc/?C=M;O=D) in the file -->
<!-- `geostat_talk16.zip`. --><a href="gis.html#fnref44" class="footnote-back">↩︎</a></p></li>
<li id="fn45"><p>By the way, it is also possible to use R from within Desktop GIS software packages.
The so-called R-ArcGIS bridge (see <a href="https://github.com/R-ArcGIS/r-bridge" class="uri">https://github.com/R-ArcGIS/r-bridge</a>) allows R to be used from within ArcGIS.
One can also use R scripts from within QGIS (see <a href="https://docs.qgis.org/2.18/en/docs/training_manual/processing/r_intro.html" class="uri">https://docs.qgis.org/2.18/en/docs/training_manual/processing/r_intro.html</a>).
Finally, it is also possible to use R from the GRASS GIS command line (see <a href="https://grasswiki.osgeo.org/wiki/R_statistics/rgrass7" class="uri">https://grasswiki.osgeo.org/wiki/R_statistics/rgrass7</a>).<a href="gis.html#fnref45" class="footnote-back">↩︎</a></p></li>
<li id="fn46"><p>
Note also that the <strong>RSAGA</strong> package uses the command line interface to use SAGA geoalgorithms from within R (see Section <a href="gis.html#rsaga">9.3</a>). <a href="gis.html#fnref46" class="footnote-back">↩︎</a></p></li>
<li id="fn47"><p>
SQLite/SpatiaLite are certainly also important but implicitly we have already introduced this approach since GRASS is using SQLite in the background (see Section <a href="gis.html#rgrass">9.4</a>).<a href="gis.html#fnref47" class="footnote-back">↩︎</a></p></li>
<li id="fn48"><p>
Thanks to Manning Publications, Regina Obe and Leo Hsu for permission to use this example.<a href="gis.html#fnref48" class="footnote-back">↩︎</a></p></li>
<li id="fn49"><p>
QGIS Cloud lets you store geographic data and maps in the cloud.
In the background, it uses QGIS Server and PostgreSQL/PostGIS.
This way, the reader can follow the PostGIS example without the need to have PostgreSQL/PostGIS installed on a local machine.
Thanks to the QGIS Cloud team for hosting this example.<a href="gis.html#fnref49" class="footnote-back">↩︎</a></p></li>
<li id="fn50"><p>
The prefix <code>st</code> stands for space/time.<a href="gis.html#fnref50" class="footnote-back">↩︎</a></p></li>
<li id="fn51"><p>
It is important to close the connection here because QGIS Cloud (free version) allows only ten concurrent connections.<a href="gis.html#fnref51" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<script>
/*
Sorts the references alphabetically.
Modified from code by Yvonne Aburrow.
*/
$(function(){
    var elems = $('#refs').children('div').remove();
    elems.sort(function (a, b) {
        return $(b).children('p').html().toUpperCase() > $(a).children('p').html().toUpperCase() ? -1 : 1;
    });
    $('#refs').append(elems);
})
</script>
            </section>

          </div>
        </div>
      </div>
<a href="adv-map.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="algorithms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Robinlovelace/geocompr/edit/master/09-gis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
